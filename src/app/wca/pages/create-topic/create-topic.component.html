<nav aria-label="breadcrumb" class="coursebreadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/Admin/auth/Wca">Home</a></li>
        <li class="breadcrumb-item">
            <a href="/Admin/auth/Wca">Course Management</a></li>
        <li class="breadcrumb-item"><a href="/Admin/auth/Wca">Courses</a></li>

        <li class="breadcrumb-item">
            <a href="/Admin/auth/Wca/addcourse?edit=true&viewingModule={{query.viewingModule}}">
                <ng-container *ngIf="!query.addModule; else isEditCourse">
                    Create Course
                </ng-container>
                <ng-template #isEditCourse>
                    Edit Courses
                </ng-template>

            </a></li>
        <ng-container *ngIf="query.addModule == 'true' || query.edit; else createModule">
            <li class="breadcrumb-item">
                <a
                    href="/Admin/auth/Wca/addmodule?courseId={{query.viewingModule}}&courseImage={{query.image}}&courseName={{query.courseName}}">Add
                    Module</a>
            </li>
        </ng-container>
        <ng-template #createModule>
            <li class="breadcrumb-item">
                <a
                    href="/Admin/auth/Wca/viewmodule?viewingModule={{query.viewingModule}}&image={{query.image}}&courseName={{query.courseName}}">Create
                    Module</a>
            </li>
        </ng-template>

        <li *ngIf="query.isCreateTemp" class="breadcrumb-item">
            <a
                href="/Admin/auth/Wca/addtemplate?addModule={{query.addModule}}&viewingModule={{query.viewingModule}}&image={{query.image}}&courseName={{query.courseName}}">
                Create template
            </a>
        </li>
        <li *ngIf="query.isChooseTemp" class="breadcrumb-item">
            <a
                href="/Admin/auth/Wca/choosetemplate?addModule={{query.addModule}}&viewingModule={{query.viewingModule}}&image={{query.image}}&courseName={{query.courseName}}">
                Choose template
            </a>
        </li>
        <li class="breadcrumb-item active">
            <ng-container *ngIf="query.edit; else isNoEdit">
                Edit Topic
            </ng-container>
            <ng-template #isNoEdit>
                Add Topic
            </ng-template>
        </li>
    </ol>
</nav>

<div *ngIf="!queryData?.template_details || queryData === undefined" class="dspFlx">
    <span style="color: red;">Go Back and Choose or Create the Template Please !!!</span>
</div>


<span *ngIf="createTopicForm?.controls">
    <form [formGroup]="createTopicForm" (ngSubmit)="addTopicFrom()" class="formHeight">
        <div class="container wrap-body">
            <div style="display: flex;">
                <span *ngIf="queryData?.template_details" class="firstSpan"> Enter Module Name : </span>
                <span *ngIf="queryData?.template_details">
                    <input class="Bcg" type="text" placeholder="Enter the Name" formControlName="modulename" required />
                </span>
                <span class="validmodule"> <small
                        *ngIf="createTopicForm?.controls?.modulename?.errors?.required && submitted">Module Name
                        Required !!!</small>
                </span>
            </div>


            <span *ngIf="createTopicForm?.get('moduledetails')?.controls">
                <div [hidden]="j?.value?.topicstatus === 'false'" class="row" formArrayName="moduledetails"
                    *ngFor="let j of createTopicForm.get('moduledetails').controls; let i = index;">

                    <div class="col-md-12">
                        <mat-accordion>
                            <mat-expansion-panel [expanded]="true" class="bcgClrSync">

                                <mat-card style="text-align: center;">
                                    <mat-grid-list [cols]="breakpoint" rowHeight="1.70:2">

                                        <div class="example-list">
                                            <div *ngIf="queryData">
                                                <!-- *ngFor="let item of queryData.template_details; let m = index" -->
                                                <div class="example-box1">
                                                    <div (click)="activate(queryData?.template_details[i])"
                                                        class="clickBcg bcgBorder"
                                                        [class.active]="queryData?.template_details[i]?.name === active?.name">
                                                        <div class="dspFlx" [formGroupName]="i">
                                                            <span class="restictWidth">
                                                                <mat-form-field class="matWidth" appearance="outline">
                                                                    <mat-label class="clrLabel">Topic Name</mat-label>
                                                                    <input matInput style="color:black;"
                                                                        formControlName="topicname">
                                                                    <mat-error
                                                                        *ngIf="(!j?.value?.topicname) && submitted">
                                                                        Topic Name Required !!! </mat-error>
                                                                </mat-form-field>

                                                            </span>
                                                            <span class="example-spacer"></span>
                                                            <span *ngIf="query?.edit">
                                                                <mat-icon style="display: none;">save</mat-icon>
                                                                <mat-icon (click)="DeleteTopic(i,$event)">delete
                                                                </mat-icon>
                                                            </span>
                                                        </div>
                                                        <div class="colView">
                                                            <input style="display: none;" [id]="'fileInput3'+i"
                                                                type='file' #fileInput3
                                                                (change)="onSelectFile($event,queryData?.template_details[i],j,i)">
                                                            <span (dblclick)="fileInput3.click()"><img class="img1"
                                                                    src="{{queryData?.template_details[i]?.image}}"></span>
                                                            <span
                                                                class="padTop">{{queryData?.template_details[i]?.name}}</span>
                                                            <span class="padTop1 showCon"
                                                                *ngIf="!j?.value?.topicimages[0]"> <small>content is
                                                                    empty Double Click to edit</small></span>
                                                            <span class="padTop1"
                                                                *ngIf="queryData?.template_details[i]?.name===active?.name">
                                                                <small>{{fileType}}</small></span>
                                                                <div class="UploadBlock" *ngIf="queryData?.template_details[i].name === 'Knowledge Check'" [class.active]="queryData?.template_details[i]?.name==active?.name">
                                                                    <div style="width:85px">
                                                                    <button  *ngIf="j?.value?.topicimages[0]"  mat-raised-button class="btnprev" type="button" (click)="openPreviewModal()">preview</button></div>
                                                                    <div class="mLeft19"><mat-icon class="knowledgeIcon" (click)="sampleDownload()">get_app</mat-icon><label class="fsize12">Download question template</label></div>
                                                                    <div class="mleft3"><mat-icon class="knowledgeIcon" (click)="fileInput3.click()">publish</mat-icon><label class="fsize12">Upload Question</label></div>
                                                                </div>
                                                            <span *ngIf="j?.value?.topicimages[0] && queryData?.template_details[i].name != 'Knowledge Check'"
                                                                class="previewAndTime"
                                                                [class.active]="queryData?.template_details[i]?.name==active?.name">
                                                                <span><button mat-raised-button class="btnprev"
                                                                        type="button"
                                                                        (click)="previewimages(j,$event,queryData?.template_details[i])">preview</button></span>
                                                                <span class="dspFlxinside">
                                                                    <small class="spanTime"> Time required to complete
                                                                        the topic </small>
                                                                    <mat-card class="matcardTime">
                                                                        00:00
                                                                    </mat-card>
                                                                </span>
                                                            </span>
                                                            <div class="UploadVidBlock row previewAndTime" *ngIf="queryData?.template_details[i].name === 'Video'" [class.active]="queryData?.template_details[i]?.name==active?.name">
                                                                <div class="col-md-4">
                                                                    <div class="vidCol1">
                                                                        <div class="subTitle">
                                                                            <mat-slide-toggle [checked]="subTitleVal" (change)="toggle_sub_trans($event,'subtitle')">Subtitle</mat-slide-toggle>
                                                                        </div>
                                                                        <div *ngIf="showSubupload">
                                                                            <div class="subTitleUpload" *ngFor="let no of subtitles;let i = index">                                                                                
                                                                                    <mat-select class="subSelect" placeholder="Language">
                                                                                        <mat-option class="h30" value="English">English</mat-option>                                                                                        
                                                                                      </mat-select>                                                                                 
                                                                                <div class="chooseFile">
                                                                                    <button class="subButton" type="button">Choose file</button>
                                                                                </div>
                                                                                  <div class="addSub">
                                                                                    <mat-icon *ngIf="i == 0" (click)="addSubTile('sub')">add_circle</mat-icon>
                                                                                    <mat-icon *ngIf="i != 0" (click)="removeSubTile(i,'sub')">delete</mat-icon>
                                                                                  </div>
                                                                            </div>
                                                                        </div>
                                                                        
                                                                        <div class="transcript">
                                                                            <mat-slide-toggle [checked]="transcriptVal" (change)="toggle_sub_trans($event,'transcript')">Transcript</mat-slide-toggle>
                                                                        </div>
                                                                        <div *ngIf="showTransupload">
                                                                            <div class="subTitleUpload" *ngFor="let no of transcripts;let i = index">
                                                                                <mat-select class="subSelect" placeholder="Language">
                                                                                    <mat-option class="h30" value="English">English</mat-option>
                                                                                  </mat-select>                                                                                 
                                                                            <div class="chooseFile">
                                                                                <button class="subButton" type="button">Choose file</button>
                                                                            </div>
                                                                              <div class="addSub">
                                                                                <mat-icon *ngIf="i == 0" (click)="addSubTile('tra')">add_circle</mat-icon>
                                                                                <mat-icon *ngIf="i != 0" (click)="removeSubTile(i,'tra')">delete</mat-icon>
                                                                              </div>
                                                                        </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4">
                                                                    <div class="input-container">
                                                                        <input class="input-field" type="text" placeholder="Add url" required />
                                                                        <button class="input-button" type="button">Browse</button>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4">
                                                                    <div class="vidCol3">
                                                                        <span class="dspFlxinside">
                                                                            <small class="spanTime"> Time required to complete
                                                                                the topic </small>
                                                                            <mat-card class="matcardTime">
                                                                                00:00
                                                                            </mat-card>
                                                                        </span>
                                                                    </div>
                                                                </div>                                                                   
                                                            </div>
                                                            <span *ngIf="!j?.value?.topicimages[0] && submitted"><small
                                                                    class="FileuploadValid">FileUpload Required
                                                                    !!!</small></span>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>




                                        </div>

                                    </mat-grid-list>
                                </mat-card>


                            </mat-expansion-panel>
                        </mat-accordion>
                    </div>
                </div>
            </span>
            <div *ngIf="queryData?.template_details" class="dspFlx">
                <button class="backgroundcol2" (click)="addTopicFrom($event,'draft')" type="button">Save as a
                    draft</button>
                <span class="padTwoSides"> <button class="backgroundcol1" (click)="addTopicFrom($event,'create')"
                        type="button">Create</button></span>
                <button class="backgroundcol1" [routerLink]="['/Admin/auth/Wca']" type="button">Cancel</button>

            </div>
        </div>
    </form>

<!-- Knowledge check preview modal -->
    <div class="modal fade" id="knowlegeCheckModal" role="dialog">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <label class="modal-title">Knowledge Check</label>
            </div>
            <div class="modal-body">
                <owl-carousel-o *ngIf="displaySlides" [options]="KnowledgeOptions" class="questionList">
                    <ng-template *ngFor="let value of questionPreData;let i = index" carouselSlide>
                       <div class="questionContainer">
                        <div class="queValue">
                           Question &nbsp;{{i + 1}}
                        </div>
                        <div class="queQuery">
                            {{value.Question}}
                        </div>
                        <ng-container>
                            <section class="queOptions">
                                <mat-radio-group [(ngModel)]="labelPosition">
                                    <div>
                                        <mat-radio-button value="Option1">{{value.Option1}}</mat-radio-button>
                                    </div>
                                    <div>
                                        <mat-radio-button value="Option2">{{value.Option2}}</mat-radio-button>
                                    </div>
                                    <div>
                                        <mat-radio-button value="Option3">{{value.Option3}}</mat-radio-button>
                                    </div>
                                    <div>
                                        <mat-radio-button value="Option4">{{value.Option4}}</mat-radio-button>
                                    </div>
                                  </mat-radio-group> 
                            </section>                          
                        </ng-container>
                        <div class="queValue">
                            Answer
                        </div>
                        <div class="queAnswer">
                            {{value.Answer}}
                        </div>
                        <div class="queValue">
                          Reason
                        </div>
                        <div class="queAnswer">
                            {{value.Reason}}
                        </div>
                       </div>
                       <div class="mright34">
                        <button class="backgroundcol1 cancelBtn" type="button">Cancel</button>
                        <button class="backgroundcol2" type="button">Save</button>
                       </div>
                    </ng-template>
                  </owl-carousel-o>
            </div>
          </div>
          
        </div>
      </div>
</span>