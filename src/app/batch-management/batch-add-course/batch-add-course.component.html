<div class="batch-course-container">
  <nav aria-label="breadcrumb" class="coursebreadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a [routerLink]="['/Admin/auth/userManagement']">Home</a></li>
        <li class="breadcrumb-item"><a [routerLink]="['/Admin/auth/Wca']">Batch</a></li>
        <li class="breadcrumb-item active" aria-current="page">Add Courses</li>
    </ol>
</nav>
<div class="row">
<div class="col-md-12">
  <div class="batch-btn p-1">
    <button mat-flat-button color="primary" *ngIf="selectedCourseArray.length != 0" (click)="addCourses()">Add Courses</button>
  </div>
</div>
</div>
<hr>
<div class="row">
  <div class="col-md-12">
    <div class="pl-3">
      <h2>Selected Courses ({{selectedCourseArray.length}})</h2>
    </div>
  </div>
  <div class="col-md-12">
    <div class="tag-container p-3 m-2 border d-flex">
      <div class="m-l-50" *ngIf="selectedCourseArray.length == 0">
        Add Course!...
      </div>
      <span *ngFor="let selection of selectedCourseArray;let i = index">
       <div *ngIf="selectedCourseArray.length > 0" class="course-tag">{{selection.course_name}}<i class="fa fa-times-circle pl-3" (click)="selectCourse(selection)"></i></div>
      </span>
    </div>
  </div>
</div>
<hr class="dotted-hr">
<div class="row">
  <div class="col-md-6">
    <div class="pl-3">
      <h2>Select Course</h2>
    </div>
  </div>
  <div class="col-md-6">
    <div class="batch-btn p-1 float-right">
      <button *ngIf="courses" mat-flat-button class="w-100" color="primary" (click)="selectAll()">Select all</button>
    </div>
  </div>
</div>
<div class="container  pb-5">
  <div class="container shadow margin20">
    <div class="row">  
      <div class="card col-md-3 cardheight left" infiniteScroll [infiniteScrollDistance]="2"
      [scrollWindow]="false" [infiniteScrollThrottle]="500" (scrolled)="onScrollDown()">
      <h2 class="list-title m-t-20 m-l-5 m-r-20 color_grey">Category list </h2>
      <mat-tree [dataSource]="treeSource" [treeControl]="treeControl" [trackBy]="trackBy">
        <!-- This is the tree node template for leaf nodes -->
        <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
          <li class="mat-tree-node newstyle" renderDebug>
            <!-- use a disabled button to provide padding for tree leaf -->
            <button mat-icon-button matTreeNodeToggle class="btnClassicon" (click)="loadsubcategory(node)"
              [attr.aria-label]="'toggle ' + node.name">
              <mat-icon *ngIf="node?.is_child == true" class="mat-icon-rtl-mirror">
                {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
              </mat-icon>
            </button>
            <mat-checkbox name="checkbox" [(ngModel)]="node.checkbox" (change)="selectedcategory(node,'category')">
              {{node?.category_name}} {{node?.sub_category_name}} {{node?.super_sub_category_name}}</mat-checkbox>
          </li>
        </mat-tree-node>
        <!-- node with children -->
        <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
          <li class="mat-tree-node newstyle" renderDebug>
            <div class="mat-tree-node">
              <button mat-icon-button matTreeNodeToggle class="btnClassicon"
                [attr.aria-label]="'toggle ' + node.name">
                <mat-icon *ngIf="node?.is_child == true" class="mat-icon-rtl-mirror">
                  {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                </mat-icon>
              </button>
              <mat-checkbox name="checkbox" [(ngModel)]="node.checkbox" (change)="selectedcategory(node,'subcategory')">
                {{node?.category_name}} {{node?.sub_category_name}} {{node?.super_sub_category_name}}</mat-checkbox>
            </div>
          </li>
          <ul [class.children-invisible]="!treeControl.isExpanded(node)">
            <ng-container matTreeNodeOutlet></ng-container>
          </ul>
        </mat-nested-tree-node>
      </mat-tree>
      <!-- view category and sub category -->
    </div>
    <div class="card col-md-9 cardheight left">
       <!-- start of navigations ( engineering > electronics > nano electronics) -->
       <ol class="breadcrumb category-nav m-b-0">
        <li class="breadcrumb-item"
          (click)="selectedCategory?.category_name != undefined && changeNav('addCategoryForm')"
          *ngIf="showAddCatForm || selectedCategory?.category_name != undefined;">
          {{selectedCategory?.category_name || 'Category >'}}</li>
        <li *ngIf="showAddSubCatForm || selectedSubCategory?.sub_category_name != undefined"
          (click)="selectedSubCategory?.sub_category_name != undefined && changeNav('addSubCategoryForm')"
          aria-current="page" class="breadcrumb-item">{{selectedSubCategory.sub_category_name || 'Sub Category > '}}
        </li>
        <li class="breadcrumb-item" (click)="selectedSuperSubCategory?.super_sub_category_name != undefined && 
        changeNav('addSuperSubCategoryForm')" *ngIf="selectedSuperSubCategory?.super_sub_category_name != undefined"
          aria-current="page">{{selectedSuperSubCategory.super_sub_category_name || 'Sub Category >'}}</li>
      </ol>
      <div class="m-r-20 m-l-20 m-t-10">
        <div *ngIf="!courses || courses.length == 0">
          <h2 class="text-center">No courses found</h2>
        </div>
        <div class="row" *ngIf="courses">
          <div class="col-lg-3 col-md-4 col-sm-6 col-12  width_80 containerOverlay"
            *ngFor="let courses of courses; let i = index">
            <img class="pointer m-b-10 course-image center" src="{{ courses.course_img_url }}" alt=""
              (click)="selectCourse(courses,i+'c')">
            <div class="overlay" *ngIf="courses.isChecked" (click)="selectCourse(courses,i+'c')">
              <img src="assets/courses/selectimagefull.png" alt="" width="100%" height="100px">
            </div>
            <div class="row color_blue width_80 f_wt_500 center_align center m-b-10 m-t-10">
              {{courses.course_name}}
            </div>
          </div>
        </div>
      </div>
      <div class="row pos_bottom" *ngIf="courseCount >= 10">
        <button mat-icon-button aria-label="More Icon" class="center" (click)="getNextCourse()">
          <mat-icon>arrow_drop_down</mat-icon>
        </button>
      </div>
        </div>
    </div>
  </div>
</div>
