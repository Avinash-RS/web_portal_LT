<app-header></app-header>
<button mat-button class="backbtn" [routerLink]="['/Learner/home']">
    <mat-icon class="backIcon">keyboard_backspace</mat-icon>
    &nbsp; Back to My Courses
</button>

<div class="row">
    <div class="col-12">
        <h1 class="nameh1">{{course?.course_name | titlecase }}</h1>
    </div>
</div>

<div class="container007">
    <mat-drawer-container [class.drawer-opened]="drawer.opened" class="course-details-container">
        <mat-drawer #drawer class="drawer" mode="side" opened="true">
            <mat-toolbar class="header">
                <div class="row margin-15">
                    <div class="col-6 Outine">
                        Course outline
                    </div> |
                    <div class="col-6">
                        <div class="row">
                            <div class="col-2">
                                <mat-icon class="alarmIcon">alarm</mat-icon>
                            </div>
                            <div class="col-4">
                                <span class="courseTime">{{content?.coursetime}}</span>
                            </div>
                        </div>
                    </div>
                </div>
                <mat-icon class="close" (click)="drawer.close()">menu</mat-icon>
            </mat-toolbar>
            <div class="contents">

                <mat-accordion *ngFor="let res of scromModuleData; let i = index"
                    (click)="getSelectedIndex(i); getModuleDataForForum(scromModuleData.length, i + 1, res)">
                    <mat-expansion-panel class="panel" hideToggle="true" #example [expanded]="selectedIndex === i">
                        <mat-expansion-panel-header>
                            <mat-panel-title class="module-container">
                                <div class="row">
                                    <div style="margin-top: 8px;">
                                        <span class='index-number'>{{i+1}}</span>
                                    </div>
                                    <div>
                                        <div class="moduleHead" matTooltip="{{res?.title}}">
                                            <div class="modhead">{{res?.title}}</div>
                                        </div>
                                    </div>
                                </div>


                                <span class="moduleund">
                                    <mat-icon class="time-icon">alarm</mat-icon>
                                    <span class="course-time">
                                        {{res?.moduletime}}
                                    </span>
                                </span>

                            </mat-panel-title>
                            <span *ngIf="res?.status == 'Passed'"
                                class="material-icons mod-check-iconmod-check-icon mar">done</span>
                            <mat-icon *ngIf="!example.expanded" class="exp-icon">add_circle_outline
                            </mat-icon>
                            <mat-icon *ngIf="example.expanded" class="exp-icon">remove_circle_outline
                            </mat-icon>

                        </mat-expansion-panel-header>
                        <div class="row">
                            <div class="col-12">
                                <mat-vertical-stepper [linear]="isLeaner">
                                    <ng-container *ngFor="let mod of res?.children; let j = index">
                                        <mat-step [aria-labelledby]="mod.status === 'Passed' ? 'colgreen' : 
                                        mod.status === 'Process' ? 'colYellow' : 'colWhite'">

                                            <ng-template matStepLabel>
                                                <span
                                                    (click)="playTopic(mod.link,mod.title,mod.status,res?.title,res?.status,scromModuleData.length,res?.topic_len,j + 1)">
                                                    {{mod?.title}}</span>
                                            </ng-template>
                                        </mat-step>
                                    </ng-container>
                                </mat-vertical-stepper>
                            </div>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </div>
        </mat-drawer>

        <div class="main contents">
            <div class="spinner-container" *ngIf="loading">
                <mat-spinner diameter="40"></mat-spinner>
            </div>

            <mat-icon *ngIf="!drawer.opened" (click)="drawer.toggle()">menu</mat-icon>

            <iframe class="player" [src]="urlSafe" allowfullscreen></iframe>

            <div class="">
                <mat-tab-group>
                    <mat-tab label="About the course">
                        <h3 class="head-h1">Course description</h3>
                        <div class="vertical"></div>

                        <div class="curInclu">This course includes :</div>
                        <div class="row display_flex">
                            <div style="max-width: 196px;">
                                <span class="font-color;padding: 5px">{{content?.totalResourseCount}} downloadable
                                    resources</span>
                            </div>&nbsp; |&nbsp;
                            <div style="max-width: 100px;">
                                <span class="font-color;padding: 5px">
                                    {{course?.course_mode === 'self-placed' ? 'Self paced' : course?.course_mode}}</span>
                            </div>&nbsp; |&nbsp;
                            <div style="max-width: 78px;">
                                <span class="font-color;padding: 5px">{{course?.course_language}}</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="desc" [innerHTML]="course?.course_long_description">

                                </div>
                            </div>
                        </div>

                        <div *ngIf="course?.author_details[0].author_name != ''">
                            <h3 class="head-h2">Instructors</h3>
                            <div class="vertical"></div>
                            <div class="instr-box" *ngFor="let author of course?.author_details">
                                <div class="row">
                                    <div class="col-4">
                                        <img class="img-inst"
                                            [src]="author.image ? author?.image : 'assets/learner/pro2.png'" alt="">
                                    </div>
                                    <div class="col-6">
                                        <div class="authorname">{{author?.author_name | titlecase}}</div>
                                    </div>

                                    <div class="row margin-35 borderline">
                                        <div class="col-12 bottom-border">
                                            <p class="author-desc">{{author?.description}}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </mat-tab>

                    <mat-tab label="Resources">
                        <mat-accordion>
                            <ng-container *ngIf="content?.noresource">
                                <ng-container *ngFor="let res of content?.coursedetails; let i = index">
                                    <mat-expansion-panel class="panel1" hideToggle="true" #example1
                                        [expanded]="selectedIndex === i" *ngIf="res.resValue">
                                        <mat-expansion-panel-header style="height: 50px !important;">
                                            <mat-panel-title>
                                                <span
                                                    class="sqnumner">{{i+1}}.</span>&nbsp;&nbsp;{{res?.modulename}}<br>
                                            </mat-panel-title>
                                            <mat-icon class="exp2" *ngIf="!example1.expanded">add_circle_outline
                                            </mat-icon>
                                            <mat-icon class="exp2" *ngIf="example1.expanded">remove_circle_outline
                                            </mat-icon>
                                        </mat-expansion-panel-header>


                                        <div class="row margin-5">
                                            <div class="col-12">
                                                <mat-list *ngFor="let mod of res?.moduledetails">
                                                    <mat-list-item *ngIf="res.resValue">
                                                        <div mat-line class="modTopName"
                                                            *ngIf="mod.resourse?.files.length">
                                                            {{mod?.topicname}} :</div>
                                                        <div class="content">
                                                            <div class="row" *ngFor="let file of mod.resourse?.files">
                                                                <div class="col-12" style="margin-top:6px">
                                                                    <div class="row">
                                                                        <img *ngIf="file.doc_type == 'application/pdf'"
                                                                            class="size" alt=""
                                                                            src="assets/learner/fileicon/PDF_Icon.svg">
                                                                        <img *ngIf="file.doc_type == 'link'"
                                                                            class="size" alt=""
                                                                            src="assets/learner/fileicon/Link_Icon.svg">
                                                                        <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                                                            class="size" alt=""
                                                                            src="assets/learner/fileicon/Excel_Icon.svg">
                                                                        <img *ngIf="file.doc_type == 'image/jpeg' || file.doc_type == 'image/png' "
                                                                            class="size" alt=""
                                                                            src="assets/learner/fileicon/Image_Icon.svg">
                                                                        <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                                                            class="size" alt=""
                                                                            src="assets/learner/fileicon/PPT_Icon.svg">
                                                                        <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                                                            class="size" alt=""
                                                                            src="assets/learner/fileicon/Word_Icon.svg">

                                                                        <img *ngIf="file.doc_type == 'application/msword'"
                                                                            class="size" alt=""
                                                                            src="assets/learner/fileicon/Word_Icon.svg">

                                                                        <img *ngIf="file.doc_type == 'application/vnd.ms-excel'"
                                                                            class="size" alt=""
                                                                            src="assets/learner/fileicon/Excel_Icon.svg">



                                                                        <mat-icon class="docType"
                                                                            *ngIf="file.doc_type == 'text/plain' ">
                                                                            description
                                                                        </mat-icon>
                                                                        <div class="col-8">
                                                                            {{file.type_name}}
                                                                        </div>
                                                                        <div class="col-2 f_size_12" *ngIf="file?.size">
                                                                            {{file.size}}
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <a href="{{file?.path}}" download>
                                                                                <mat-icon
                                                                                    style="color: #333;font-size: 20px;">
                                                                                    save_alt </mat-icon>
                                                                            </a>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </mat-list-item>
                                                </mat-list>
                                            </div>
                                        </div>
                                    </mat-expansion-panel>
                                </ng-container>
                            </ng-container>


                            <ng-container *ngIf="!content?.noresource">
                                <span>This course does not have resource files.</span>
                            </ng-container>
                        </mat-accordion>
                    </mat-tab>

                    <!-- Assignments tab -->
                    <mat-tab label="Assignments" class="discussion_forum"
                        *ngIf="assignmentContent?.coursedetails.length">
                        <mat-accordion>
                            <ng-container>
                                <ng-container *ngFor="let res of assignmentContent?.coursedetails; let i = index">

                                    <mat-expansion-panel class="panel1" hideToggle="true" #example1
                                        [expanded]="selectedIndex === i">
                                        <mat-expansion-panel-header style="height: 50px !important;">
                                            <mat-panel-title>
                                                <span
                                                    class="sqnumner">{{i+1}}.</span>&nbsp;&nbsp;<span>{{res?.modulename}}
                                                </span>

                                            </mat-panel-title>
                                            <mat-icon class="exp2" *ngIf="!example1.expanded">add_circle_outline
                                            </mat-icon>
                                            <mat-icon class="exp2" *ngIf="example1.expanded">remove_circle_outline
                                            </mat-icon>
                                        </mat-expansion-panel-header>


                                        <div class="row margin-5">
                                            <div class="col-12">
                                                <mat-list *ngFor="let mod of res?.moduledetails">
                                                    <mat-list-item>
                                                        <div mat-line class="modName">
                                                            <span> {{mod?.topicname}} :</span> </div>
                                                        <!-- <div class="content"> -->
                                                        <div class="row" *ngFor="let file of mod.resourse?.files">
                                                            <div class="col-12" style="margin-top:6px"
                                                                *ngIf="file?.assignment === true">
                                                                <div class="row">
                                                                    <img *ngIf="file.doc_type == 'application/pdf'"
                                                                        class="size" alt=""
                                                                        src="assets/learner/fileicon/PDF_Icon.svg">
                                                                    <img *ngIf="file.doc_type == 'link'" class="size"
                                                                        alt=""
                                                                        src="assets/learner/fileicon/Link_Icon.svg">
                                                                    <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                                                        class="size" alt=""
                                                                        src="assets/learner/fileicon/Excel_Icon.svg">
                                                                    <img *ngIf="file.doc_type == 'image/jpeg' || file.doc_type == 'image/png' "
                                                                        class="size" alt=""
                                                                        src="assets/learner/fileicon/Image_Icon.svg">
                                                                    <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                                                        class="size" alt=""
                                                                        src="assets/learner/fileicon/PPT_Icon.svg">
                                                                    <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                                                        class="size" alt=""
                                                                        src="assets/learner/fileicon/Word_Icon.svg">

                                                                    <img *ngIf="file.doc_type == 'application/msword'"
                                                                        class="size" alt=""
                                                                        src="assets/learner/fileicon/Word_Icon.svg">

                                                                    <img *ngIf="file.doc_type == 'application/vnd.ms-excel'"
                                                                        class="size" alt=""
                                                                        src="assets/learner/fileicon/Excel_Icon.svg">


                                                                    <mat-icon class="docType no-cursor"
                                                                        *ngIf="file.doc_type == 'text/plain' ">
                                                                        description
                                                                    </mat-icon>
                                                                    <div class="col-2 no-cursor">
                                                                        {{file.type_name}}
                                                                    </div>

                                                                    <div class="col-1 f_size_9" *ngIf="file?.size">
                                                                        {{file.size}}
                                                                    </div>
                                                                    <div class="col-1 no-cursor">
                                                                        <mat-icon *ngIf="file.enableView"
                                                                            (click)="previewDoc(previewDialog,file)"
                                                                            class="viewDoc">remove_red_eye</mat-icon>
                                                                        <mat-icon *ngIf="!file.enableView"
                                                                            class="viewDoc">remove_red_eye</mat-icon>
                                                                    </div>
                                                                    <div class="col-2" matTooltip="Course start date">
                                                                        {{courseStartDate}}
                                                                    </div>
                                                                    <div class="col-2" matTooltip="Course end date">
                                                                        {{courseEndDate}}
                                                                    </div>
                                                                    <div class="col-2" (click)="fileInput.click()">
                                                                        <button mat-stroked-button
                                                                            matTooltip="Click upload button to add the file"
                                                                            [disabled]="file?.doc_status === false || !assignmentContent?.enableUpload ||
                                                                            !file?.startDate">
                                                                            Upload</button>
                                                                        <input class="form-control border-right-0"
                                                                            [disabled]="file?.doc_status === false"
                                                                            type='file' id="upload-photo" #fileInput
                                                                            (change)="uploadAssignmentsFile($event,file._id,res?.modulename,mod?.topicname,file.type_name,file?.score,file?.endDate)">
                                                                    </div>
                                                                    <div class="col-2 disply no-cursor">
                                                                        <mat-icon class="no-cursor"
                                                                            [ngClass]="file.doc_status === true ? 'blue' : 'grey'">
                                                                            check_circle</mat-icon>
                                                                        <span style="padding-top: 4px;"
                                                                            [ngClass]="file.doc_status === true ? 'blue' : 'grey'">&nbsp;
                                                                            File has been uploaded</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- </div> -->
                                                    </mat-list-item>
                                                    <hr>
                                                </mat-list>
                                            </div>
                                        </div>
                                    </mat-expansion-panel>
                                </ng-container>
                            </ng-container>

                        </mat-accordion>
                        <ng-template #previewDialog>
                            <button mat-icon-button class="close-button" [mat-dialog-close]="true">
                                <mat-icon class="close-icon" color="warn" (click)="closedialogbox()">close</mat-icon>
                            </button>
                            <div *ngIf="docpath">
                                <app-pdfreader [url]="docpath"></app-pdfreader>
                            </div>
                        </ng-template>
                    </mat-tab>

                    <!-- Assignments tab end -->
                    <!-- Forum -->
                    <mat-tab *ngIf="userDetail.is_forum_config" label="Forum" [disabled]="selectedModuleData === null"
                        class="discussion_forum">
                        <div class="spinner-container" *ngIf="loadingForum">
                            <mat-spinner diameter="40"></mat-spinner>
                        </div>
                        <br>
                        <div *ngIf="showCourseDetails">
                            <div class="p-l-0 no_border">
                                <div class="col-12">
                                    <div class="row" *ngIf="selectedModuleData">
                                        <p (click)="gotoDisplayAllThreads()">
                                            <span
                                                class="f_size_18 color_black f_wt_400 ">{{selectedModuleData.title || 'Module Name'}}</span>
                                            &nbsp;({{'Module'+ ' ' +selectedModuleData.indexValue}}) |
                                            {{ discussionData?.topics?.length ? discussionData.topics.length : 0 }}
                                            {{discussionData?.topics?.length > 1 ? 'Threads' : 'Thread'}}
                                            <!-- {{discussionData?.topics?.length || 0}}  Threads -->
                                        </p>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div *ngIf="showCommentThread" class="no_border">
                            <div class="p-l-0">
                                <div class="col-12">
                                    <div class="row" *ngIf="selectedModuleData">
                                        <p (click)="gotoDisplayAllThreads();viewAllThreads()">
                                            <span class="color-blue f_size_16 f_wt_500"
                                                style="text-decoration-line:underline ; cursor: pointer;">{{(selectedModuleData.title | titlecase) || 'Module Name' + ' '}}({{'Module'+ ' ' +selectedModuleData.indexValue}})
                                            </span> :
                                            &nbsp;&nbsp;
                                            <!-- <span class="f_size_15 f_wt_500">{{selectedThreadData?.titleRaw | titlecase}}</span> -->
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br>
                        <mat-card class=" black_border box_shadow alignment ">
                            <div class="row" *ngIf="!showSearch">
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                                    <p class="no_margin">Sort by :
                                        <mat-form-field class="sort no_margin">
                                            <mat-select [(value)]="selected"
                                                [disabled]="discussionData === null || discussionData?.topics?.length === 0"
                                                (selectionChange)="changedSort($event.value)">
                                                <mat-option value="1">Latest</mat-option>
                                                <mat-option value="0">Oldest</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </p>
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 float_right no_padding">
                                    <div class="row">
                                        <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12">
                                            <form class="search-form">
                                                <mat-form-field class="example-full-width">
                                                    <input class="toolbar-search" [disabled]="
                                                    showCourseDetails ? (discussionData === null || discussionData?.topics?.length === 0) :
                                                    (topicDiscussionData && topicDiscussionData?.posts?.length === 1)"
                                                        type="text" matInput name="searchbar" [(ngModel)]="filterValue"
                                                        (input)="onSearchChange($event.target.value);">
                                                    <mat-placeholder>Search</mat-placeholder>
                                                    <mat-icon matSuffix *ngIf="filterValue?.length > 0"
                                                        style="font-size: 1.2em" (click)="closeSearch()">
                                                        close</mat-icon>
                                                    <mat-icon matSuffix *ngIf="filterValue == null" [ngClass]="
                                                    (showCourseDetails && (discussionData === null || discussionData?.topics?.length === 0)) ||
                                                    (showCommentThread && topicDiscussionData && topicDiscussionData?.posts?.length === 1) ?
                                                     'pointerNone' : 'pointer'" style="font-size: 1.2em">search
                                                    </mat-icon>
                                                </mat-form-field>
                                            </form>
                                        </div>
                                        <div *ngIf="userDetail.is_thread_config"
                                            class="col-xl-4 col-lg-4 col-md-12 col-sm-12 p-5px">
                                            <button mat-button (click)="gotoNewThread(createThreadDialog)"
                                                [disabled]="course === null" class="new_Thread "
                                                style="border-radius: 0 !important;">
                                                New thread</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- <div class="row" *ngIf="showSearch">
                                <div class="col-11 center">
                                    <mat-form-field class="example-full-width">
                                        <input class="toolbar-search" type="text" matInput autofocus  [(ngModel)]="filterValue"
                                            (input)="searchThread($event.target.value); ">
                                        <mat-placeholder>Search</mat-placeholder>
                                        <mat-icon matSuffix style="font-size: 1.2em" (click)="closeSearch()">
                                            close</mat-icon>
                                    </mat-form-field>
                                </div>
                            </div> -->
                        </mat-card>

                        <div *ngIf="showCourseDetails && discussionData?.topics?.length > 0" infiniteScroll
                            [infiniteScrollDistance]="0" [infiniteScrollThrottle]="300" (scrolled)="onScrollDown()">
                            <div *ngFor="let data of discussionData?.topics">
                                <mat-card class="black_border m-bt-4 box_shadow pointer" (click)="showDetail(data)"
                                    *ngIf="!data.deleted">
                                    <div class="row">
                                        <div class="col-xl-10 col-lg-10 col-md-8 col-sm-12 col-12">
                                            <div class="row f_size_18 titlecolor">
                                                <h3> {{data?.titleRaw | titlecase}}</h3>
                                            </div>
                                            <div class="row f_size_14 date_color">
                                                <p> Last post by <strong
                                                        class="titlecolor">{{data?.user?.username | titlecase}}
                                                        &nbsp;</strong>
                                                    &nbsp; | &nbsp; {{data?.lastposttimeISO | date : 'medium'}} </p>
                                                <!-- <p class="pointer"> Created by <strong
                                                        class="titlecolor">{{data?.user?.username | titlecase}}</strong>
                                                    &nbsp; | &nbsp; {{data?.timestampISO | date : 'medium'}} </p> -->
                                            </div>
                                        </div>
                                        <div class="col-xl-2 col-lg-2 col-md-4 col-sm-4 col-4 bg_color">
                                            <div class="row center position_hgt ">{{data?.postcount-1}}</div>
                                            <div class="row center position ">
                                                <p>{{data?.postcount - 1 >= 2 ? 'Comments' : 'Comment'}}</p>
                                            </div>
                                        </div>
                                    </div>
                                </mat-card>
                            </div>
                        </div>

                        <div
                            *ngIf="!loadingForum && showCourseDetails && (discussionData === null || discussionData?.topics?.length ===0)">
                            <br><br>
                            <mat-card class="black_border m-bt-4 box_shadow center center_align f_size_16">
                                <br>
                                No threads found! create new..
                                <br> <br>
                            </mat-card>
                        </div>

                        <div class="comment_card" *ngIf="selectedThreadData != null">
                            <!-- for thread -->

                            <mat-card class="black_border m-b-10 no-radius no_padding">
                                <!-- name row start -->
                                <div class="black_border no_padding no_margin" style="background-color: #C9E4F35C;">
                                    <div class="row p-lr-30">
                                        <div class="col-xl-1 col-lg-1 col-md-3 col-sm-1 col-3 no_padding m-auto-tb">
                                            <button class="profileimg"
                                                disabled>{{selectedThreadData?.user?.username | slice:0:1 | uppercase}}</button>
                                        </div>
                                        <div class="col-xl-11 col-lg-11 col-md-9 col-sm-11 col-9 no_padding">
                                            <div class="row">
                                                <div class="col-10 m-auto-tb">
                                                    <strong
                                                        class="color-blue float_left">{{selectedThreadData?.user?.username | titlecase}}
                                                        &nbsp;
                                                    </strong> <span>
                                                        &nbsp; | &nbsp;
                                                        {{selectedThreadData?.timestampISO | date : 'medium'}} </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- name row end -->
                                <!-- content start -->
                                <div class="row p-lr-30 m-t-20">
                                    <div class=col-1></div>
                                    <div class="col-11 thread_title p-l-0">
                                        <p class="f_size_17 color_black f_wt_400 color_grey">
                                            {{selectedThreadData?.titleRaw || 'Thread name'}}
                                        </p>


                                        <div
                                            *ngIf="topicDiscussionData && topicDiscussionData?.posts && topicDiscussionData?.posts[0]">
                                            <p class="no_margin" *ngIf="topicDiscussionData?.posts[0].deleted === false"
                                                [innerHTML]="topicDiscussionData?.posts[0].content"></p>
                                            <p class="no_margin" *ngIf="topicDiscussionData?.posts[0].deleted === true"
                                                [innerHTML]="topicDiscussionData?.posts[0].local_content"></p>
                                        </div>
                                    </div>
                                </div>
                                <!--content ends  -->
                                <mat-card-actions class="no_margin no_padding">
                                    <div class="row p-lr-30 m-t-20 m-b-15">
                                        <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                        <div class="col-xl-11 col-lg-11 col-md-11 col-sm-12 col-12 no_padding">
                                            &nbsp;
                                            <button mat-button class="f_size_12 no_padding"
                                                (click)="likeandunlikepost(topicDiscussionData?.posts[0])">
                                                <mat-icon class="action_icon"
                                                    *ngIf="topicDiscussionData?.posts && !topicDiscussionData?.posts[0]?.bookmarked">
                                                    thumb_up_alt</mat-icon>
                                                <mat-icon class="action_icon_filled"
                                                    *ngIf="topicDiscussionData?.posts && topicDiscussionData?.posts[0]?.bookmarked">
                                                    thumb_up_alt</mat-icon>Like
                                                ({{topicDiscussionData?.posts && topicDiscussionData?.posts[0] && topicDiscussionData?.posts[0]?.bookmarks || 0}})
                                            </button> &nbsp;&nbsp;
                                            <button mat-button class="f_size_12 no_padding"
                                                (click)="showThreadComment = !showThreadComment"
                                                [disabled]="selectedThreadData?.thread_status === false">
                                                <mat-icon class="action_icon"
                                                    [disabled]="selectedThreadData?.thread_status === false">
                                                    comment</mat-icon>Comment
                                            </button>

                                        </div>
                                    </div>
                                    <div class="row p-lr-30" *ngIf="showThreadComment">
                                        <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                        <div
                                            class="form-group col-xl-11 col-lg-11 col-md-11 col-sm-12 col-12 no_padding m-b-0">
                                            <angular-editor [config]="config" name="addThreadComment" autofocus
                                                [placeholder]="'Leave your comments here...'"
                                                [(ngModel)]="addThreadComment" ngDefaultControl>
                                            </angular-editor>
                                        </div>
                                        <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                        <div class="col-xl-11 col-lg-11 col-md-11 col-sm-12 col-12 m-auto-tb p-5px"
                                            style="background: whitesmoke; border: 1px solid #dddddd;  margin-bottom: 16px;">
                                            <button mat-button class="new_Thread no-radius ht-30"
                                                [disabled]="addThreadComment == null || addThreadComment?.length == 0"
                                                (click)="sendComment('thread',addThreadComment)">Send</button>
                                        </div>
                                        <!-- <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12  float_right send_pos  black_bo">
                                    <mat-icon class="send_btn" [disabled]="addThreadComment == null || addThreadComment?.length == 0"
                                      (click)="sendComment('thread',addThreadComment)">send</mat-icon>
                                  </div> -->
                                    </div>
                                    <!-- <div class="row p-lr-30 float_right black_bo" *ngIf="showThreadComment">
                                  <button mat-button class="new_Thread no-radius float_right ht-30"
                                    [disabled]="addThreadComment == null || addThreadComment?.length == 0"
                                    (click)="sendComment('thread',addThreadComment)">Send</button>
                                </div> -->
                                </mat-card-actions>
                            </mat-card>
                            <!-- for posts -->
                            <div *ngFor="let post of topicDiscussionData?.posts; let pin = index;">
                                <mat-card *ngIf="pin !== 0" [disabled]="post.deleted" class="no-radius no_padding"
                                    [ngClass]="post.deleted === false ? 'black_border m-b-8 ' : 'black_border m-b-8 white_card'">
                                    <div class="black_border no_padding no_margin" style="background-color: #F1F1F1;">
                                        <div class="row padding_matcard">
                                            <div class="col-xl-1 col-lg-1 col-md-3 col-sm-1 col-3 no_padding">
                                                <button class="profileimg"
                                                    disabled>{{post?.user?.username | slice:0:1 | uppercase}}</button>
                                            </div>
                                            <div class="col-xl-11 col-lg-11 col-md-9 col-sm-11 col-9 no_padding">
                                                <div class="row ">
                                                    <div class="col-12 m-auto-tb">
                                                        <strong
                                                            class="color-blue float_left">{{post?.user?.username | titlecase}}
                                                            &nbsp;</strong>
                                                        <span> &nbsp; | &nbsp; {{post?.timestampISO | date : 'medium'}}
                                                            &nbsp; </span>
                                                        <span class="a2i_lable" *ngIf="post.a2i_lable"> A2I</span>
                                                    </div>
                                                </div>

                                                <!-- <mat-slide-toggle class="mat-slide-toggle mat-primary mat-checked float_right"
                                      [(ngModel)]="post.deleted" (change)="removeComment(post)">Remove</mat-slide-toggle> -->



                                                <!-- <p [innerHTML]="post?.content" style="word-break: break-word ;"></p> -->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row p-lr-30 m-t-20">
                                        <div class="col-xl-1 col-lg-1 col-md-3 col-sm-1 col-3 no_padding">
                                        </div>
                                        <div class="col-xl-11 col-lg-11 col-md-9 col-sm-11 col-9 no_padding">
                                            <p class="no_margin" *ngIf="post?.deleted === false"
                                                [innerHTML]="post?.content"></p>
                                            <p class="no_margin" *ngIf="post?.deleted === true"
                                                [innerHTML]="post?.local_content"></p>
                                        </div>
                                    </div>
                                    <mat-card-actions class="no_margin no_padding">
                                        <div class="row p-lr-30 m-t-20 m-b-15">
                                            <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                            <div class="col-xl-11 col-lg-11 col-md-11 col-sm-12 col-12 no_padding">
                                                &nbsp;
                                                <button mat-button class="f_size_12 no_padding"
                                                    (click)="likeandunlikepost(post)">
                                                    <mat-icon class="action_icon" *ngIf="!post.bookmarked">
                                                        thumb_up_alt</mat-icon>
                                                    <mat-icon class="action_icon_filled" *ngIf="post.bookmarked">
                                                        thumb_up_alt</mat-icon>Like
                                                    ({{post?.bookmarks || 0}})
                                                </button> &nbsp;&nbsp;
                                                <button mat-button
                                                    [disabled]="selectedThreadData?.thread_status === false"
                                                    (click)="showCommentEditor[pin] = !showCommentEditor[pin]"
                                                    class="f_size_12 no_padding">
                                                    <mat-icon class="action_icon"
                                                        [disabled]="selectedThreadData?.thread_status === false">
                                                        comment</mat-icon>Comment
                                                </button>
                                            </div>
                                        </div>
                                        {{showCommentEditor[pin]}}
                                        <div class="row p-lr-30" *ngIf="showCommentEditor[pin]">
                                            <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                            <div
                                                class="form-group col-xl-10 col-lg-10 col-md-10 col-sm-12 col-12 no_padding m-b-0">
                                                <angular-editor [config]="config" autofocus name="addPostComment[pin]"
                                                    [placeholder]="'Leave your comments here...'"
                                                    [(ngModel)]="addPostComment[pin]" ngDefaultControl>
                                                </angular-editor>
                                            </div>
                                            <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                            <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                            <div class="col-xl-10 col-lg-10 col-md-10 col-sm-12 col-12 m-auto-tb p-5px m-b-15"
                                                style="background: whitesmoke; border: 1px solid #dddddd;">
                                                <button mat-button class="new_Thread no-radius ht-30"
                                                    (click)="sendComment('post',addPostComment[pin],addPostComment,post)"
                                                    [disabled]="addPostComment && addPostComment[pin] == null">Send</button>
                                            </div>
                                            <!-- <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12  float_right send_pos black_bo">
                                      <mat-icon (click)="sendComment('post',addPostComment[pin],addPostComment,post)"
                                        [disabled]="addPostComment && addPostComment[pin] == null" class="send_btn">send</mat-icon>
                    
                                    </div> -->
                                        </div>
                                    </mat-card-actions>

                                    <!-- // 1st child -->
                                    <div *ngFor="let posts of topicDiscussionData?.posts; let pjn = index;">
                                        <div style="padding: 0px 10px 5px 10px;">
                                            <mat-card class="no-radius no_padding black_border m-bt-4"
                                                *ngIf="pjn !== 0 && post.pid.toString() === posts.toPid">
                                                <div class="black_border no_padding no_margin"
                                                    style="background-color: #F1F1F15C;">
                                                    <div class="row padding_matcard">
                                                        <div
                                                            class="col-xl-1 col-lg-1 col-md-3 col-sm-3 col-3 no_padding m-auto-tb">
                                                            <button class="profileimg"
                                                                disabled>{{posts?.user?.username | slice:0:1 | uppercase}}</button>
                                                        </div>
                                                        <div
                                                            class="col-xl-11 col-lg-11 col-md-9 col-sm-9 col-9 no_padding m-auto-tb">
                                                            <strong
                                                                class="color-blue float_left">{{posts?.user?.username | titlecase}}</strong>
                                                            <span>
                                                                &nbsp; | &nbsp;
                                                                {{posts?.timestampISO | date : 'medium'}} </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row p-lr-30 m-t-20">
                                                    <div class="col-xl-1 col-lg-1 col-md-3 col-sm-1 col-3 no_padding">
                                                    </div>
                                                    <div
                                                        class="col-xl-11 col-lg-11 col-md-9 col-sm-11 col-9 no_padding">
                                                        <p class="no_margin" *ngIf="posts?.deleted === false"
                                                            [innerHTML]="posts?.content"></p>
                                                        <p class="no_margin" *ngIf="posts?.deleted === true"
                                                            [innerHTML]="posts?.local_content"></p>
                                                    </div>
                                                </div>
                                                <mat-card-actions class="no_margin no_padding">
                                                    <div class="row p-lr-30 m-t-20 m-b-15">
                                                        <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                                        <div
                                                            class="col-xl-11 col-lg-11 col-md-11 col-sm-12 col-12 no_padding">
                                                            &nbsp;
                                                            <button mat-button class="f_size_12 no_padding"
                                                                (click)="likeandunlikepost(posts)">
                                                                <mat-icon class="action_icon"
                                                                    *ngIf="!posts?.bookmarked">
                                                                    thumb_up_alt</mat-icon>
                                                                <mat-icon class="action_icon_filled"
                                                                    *ngIf="posts.bookmarked">
                                                                    thumb_up_alt</mat-icon>Like
                                                                ({{posts?.bookmarks || 0}})
                                                            </button> &nbsp;&nbsp;
                                                            <!-- // commented by Mythreyi - no need child's child comment -->
                                                            <!-- <button mat-button
                                                                (click)="showCommentEditor[pjn] = !showCommentEditor[pjn]"
                                                                class="f_size_12 no_padding">
                                                                <mat-icon class="action_icon">
                                                                    comment</mat-icon>Comment
                                                            </button> -->
                                                        </div>
                                                    </div>
                                                    <div class="row p-lr-30" *ngIf="showCommentEditor[pjn]">
                                                        <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                                        <div
                                                            class="form-group col-xl-10 col-lg-10 col-md-10 col-sm-12 col-12 no_padding no_margin">
                                                            <angular-editor [config]="config"
                                                                [placeholder]="'Leave your comments here...'"
                                                                [(ngModel)]="addPostComment[pjn]">
                                                            </angular-editor>
                                                        </div>
                                                        <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                                        <div class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12"></div>
                                                        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-12 col-12 m-auto-tb p-5px m-b-15"
                                                            style="background: whitesmoke; border: 1px solid #dddddd;">
                                                            <button mat-button class="new_Thread no-radius ht-30"
                                                                (click)="sendComment('post',addPostComment[pjn],addPostComment,posts)">Send</button>
                                                        </div>
                                                    </div>
                                                </mat-card-actions>

                                                <!-- // 2nd child --- in learner d.f /// Refer this div-- Kani -- -->
                                                <div
                                                    *ngFor="let postss of topicDiscussionData?.posts; let pkn = index;">
                                                    <div style="padding: 0px 10px;">
                                                        <mat-card class="no-radius no_padding black_border m-bt-4"
                                                            *ngIf="pkn !== 0 && posts.pid.toString() === postss.toPid">
                                                            <div class="black_border no_padding no_margin"
                                                                style="background-color: #82f195;">
                                                                <div class="row padding_matcard">
                                                                    <div
                                                                        class="col-xl-1 col-lg-1 col-md-3 col-sm-3 col-3 no_padding m-auto-tb">
                                                                        <button class="profileimg"
                                                                            disabled>{{postss?.user?.username | slice:0:1 | uppercase}}</button>
                                                                    </div>
                                                                    <div
                                                                        class="col-xl-11 col-lg-11 col-md-9 col-sm-9 col-9 no_padding m-auto-tb">
                                                                        <strong
                                                                            class="color-blue float_left">{{postss?.user?.username | titlecase}}</strong>
                                                                        <span>
                                                                            &nbsp; | &nbsp;
                                                                            {{postss?.timestampISO | date : 'medium'}}
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row p-lr-30 m-t-20">
                                                                <div
                                                                    class="col-xl-1 col-lg-1 col-md-3 col-sm-1 col-3 no_padding">
                                                                </div>
                                                                <div
                                                                    class="col-xl-11 col-lg-11 col-md-9 col-sm-11 col-9 no_padding">
                                                                    <p class="no_margin"
                                                                        *ngIf="postss?.deleted === false"
                                                                        [innerHTML]="postss?.content"></p>
                                                                    <p class="no_margin"
                                                                        *ngIf="postss?.deleted === true"
                                                                        [innerHTML]="postss?.local_content">
                                                                    </p>
                                                                </div>
                                                            </div>
                                                            <mat-card-actions class="no_margin no_padding">
                                                                <div class="row p-lr-30 m-t-20 m-b-15">
                                                                    <div
                                                                        class="col-xl-1 col-lg-1 col-md-1 col-sm-12 col-12">
                                                                    </div>
                                                                    <div
                                                                        class="col-xl-11 col-lg-11 col-md-11 col-sm-12 col-12 no_padding">
                                                                        &nbsp;
                                                                        <button mat-button class="f_size_12 no_padding"
                                                                            (click)="likeandunlikepost(postss)">
                                                                            <mat-icon class="action_icon"
                                                                                *ngIf="!postss?.bookmarked">
                                                                                thumb_up_alt</mat-icon>
                                                                            <mat-icon class="action_icon_filled"
                                                                                *ngIf="postss.bookmarked">
                                                                                thumb_up_alt</mat-icon>Like
                                                                            ({{posts?.bookmarks || 0}})
                                                                        </button> &nbsp;&nbsp;
                                                                    </div>
                                                                </div>
                                                            </mat-card-actions>

                                                        </mat-card>
                                                    </div>
                                                </div>

                                            </mat-card>
                                        </div>
                                    </div>


                                </mat-card>
                            </div>

                            <div> <br><br>
                                <br><br></div>
                        </div>

                        <ng-template #createThreadDialog class="dialogPopup no-radius">
                            <mat-dialog-content class="createThreadDialog no-radius">
                                <form [formGroup]="addThreadForm">
                                    <div class="row m-l-20 m-r-20 m-b-0">
                                        <div class="col-10">
                                            <p class="m-t-10 m-b-0 f_size_18">Create a new thread</p>
                                        </div>
                                        <div class="col-2">
                                            <mat-icon (click)="closedialogbox(); addThreadForm?.reset();"
                                                class="f_size_25 float_right pointer">close
                                            </mat-icon>
                                        </div>
                                    </div>
                                    <div class="row m-l-20 m-r-20 m-t-20 m-b-0" *ngIf="addThreadForm">
                                        <div class="col-12">
                                            <mat-label>Title</mat-label><span class="mand"> *</span>
                                        </div>
                                        <div class="col-12 m-b-0 form-group">
                                            <input type="text" class="width_100 greyBor background_trans"
                                                name="thread_name" formControlName="thread_name" autofocus>
                                            <div *ngIf="f.thread_name.touched && f.thread_name.errors" class="mand">
                                                <div *ngIf="f.thread_name.errors.minlength">Title must be
                                                    minimum of 8 characters </div>
                                                <div *ngIf="f.thread_name.errors.required">Title is required</div>
                                            </div>
                                            <!-- <app-input [type]="'text'" class="width_100" [form]="addThreadForm" [required]="'true'" [name]="'Thread title'"
                                      [controlname]="'title'" [reqcondition]="'req'">
                                    </app-input> -->
                                        </div>
                                    </div>

                                    <div class="row m-l-20 m-r-20 m-t-20 m-b-0">
                                        <div class="col-12">
                                            <mat-label>Description</mat-label><span class="mand"> *</span>
                                        </div>
                                        <div class="col-12 m-b-0">
                                            <div class="form-group m-b-0">
                                                <angular-editor [config]="config" formControlName="thread_description">
                                                </angular-editor>
                                                <div *ngIf="f.thread_description.touched && f.thread_description.errors"
                                                    class="mand">
                                                    <div *ngIf="f.thread_description.errors.minlength">Description must
                                                        be
                                                        minimum of 8 characters </div>
                                                    <div *ngIf="f.thread_description.errors.required">Description is
                                                        required</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                </form>
                            </mat-dialog-content>
                            <mat-dialog-actions align="end" class="dialogButtons">
                                <button mat-stroked-button class="reset" (click)="addThreadForm?.reset()"
                                    [disabled]="addThreadForm.untouched">Reset</button>
                                <button mat-stroked-button class="bg-blue color_white" (click)="createNewThread()"
                                    [disabled]="addThreadForm.invalid" cdkFocusInitial>Create</button>
                            </mat-dialog-actions>
                            <br>
                        </ng-template>
                    </mat-tab>
                </mat-tab-group>
            </div>

            <div style="height: 100px">&nbsp;</div>
        </div>
    </mat-drawer-container>


    <div class="footer">
        <span class="center_align">© 2020 L&T EduTech. &nbsp; &nbsp; | &nbsp; &nbsp;
            <span class="powered">Powered by :
                <img width="160px" alt="" src="assets/learner/LT_small.svg">
            </span>
        </span>

    </div>
</div>