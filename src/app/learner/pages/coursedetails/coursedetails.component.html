<div oncontextmenu="return false" class="coursePlayerContainer">
    <app-header></app-header>
    <!-- TITLE AND BACK -->
    <div class="d-flex justify-content-start align-items-center titlebar">
        <div class="f_size_19 pointer d-flex align-items-center redHover" (click)="goBack()">
            <mat-icon class="material-icons">arrow_back_ios</mat-icon>  Back </div>
       <div class="f_size_19" style="margin-left: 10px;"> | &nbsp;&nbsp;{{this.course?.course_name}}</div>
    </div>
    <!-- COURSE TOOL BAR -->
    <div class="d-flex toolBar">
       <div class="d-flex align-items-center leftContent">
           <div class="hamburger">
               <mat-icon class="f_size_23 mt-1" (click)="drawersOpen=drawersOpen?false:true">menu</mat-icon>
           </div>
           <div class="navigation d-flex align-items-center">
               <div>
                <mat-icon class="f_size_23 mt-1" (click)="topicPrve()">skip_previous</mat-icon>
               </div>
               <div class="currentTopic">
                <span *ngIf="scromModuleData">{{scromModuleData[moduleHolder]?.children[nextPrevHolder].title}}</span>
               </div>
               <div>
                <mat-icon class="f_size_23 mt-1" (click)="topicNext()">skip_next</mat-icon>
               </div>
            
           </div>
       </div>
       <div class="rightContent d-flex justify-content-end align-items-center">
        <span class="fullScr d-flex align-items-center">
            <mat-icon (click)="makeFullScreen()">fullscreen</mat-icon>
        </span>
           <span class="d-flex align-items-center" (click)="openResourse(resourseWindow)"><mat-icon >format_list_bulleted</mat-icon></span>
       </div>
    </div>
    <!-- TOC AND PLAYER -->
    <div class="contentHeight d-flex" >
        <!-- TOC DATA -->
        <div *ngIf="drawersOpen" style="border: 1px solid;" class="tocSize" (mouseenter)="viewScrollBar = true" (mouseleave)="viewScrollBar = false" [ngClass]="viewScrollBar ? 'afterHover': 'beforeHover'">

            <mat-card *ngFor="let res of scromModuleData; let i = index" multi displayMode=""
                (click)="getSelectedIndex(i)" class="topicCard">
                        <mat-card-title (click)="moduleExpand(res,i)" class="d-flex justify-content-between align-items-center ">
                            <div class="tocTitle">Week-{{i+1}}</div>
                            <div>
                                <mat-icon  class="f_size_23 colorBlack">
                                    {{res.expanded?'remove_circle_outline':'add_circle_outline'}}
                                </mat-icon>
                            </div>
                        </mat-card-title>
                        <mat-card-subtitle (click)="moduleExpand(res,i)" class="d-flex justify-content-start align-items-center tocSubTitle">
                            <div>
                                <!-- *ngIf="res?.status == 'Passed'" -->
                                <mat-icon  class="f_size_18 mt-1">done </mat-icon>
                            </div>
                            <div>
                                <span *ngIf="res?.title?.length >= 67" class="moduleName" tooltip="{{res?.title}}"
                                    placement="right">
                                    {{res?.title | slice:0:71}}...</span>
                                <span *ngIf="res?.title?.length < 67" class="moduleName">
                                    {{res?.title}}
                                </span>
                            </div>
                        </mat-card-subtitle>

                <mat-card-content *ngIf="(res.expanded)">
                    <mat-vertical-stepper [linear]="isLeaner" [ngClass]="res?.title?.length > 39?'headerDown': ''">
                        <ng-container *ngFor="let mod of res?.children; let j = index">
                            <mat-step
                                [aria-labelledby]="mod?.status === 'Passed' ? 'colgreen' :  mod?.status === 'process' ? 'colYellow' : 'colWhite'">
                                <ng-template matStepLabel>
                                    <span class="topicnm" *ngIf="mod?.title?.length >= 65" tooltip="{{mod?.title}}"
                                        placement="right"
                                        (click)="playTopic(mod.link,mod.title,mod.status,res?.title,res?.status,scromModuleData?.length,res?.topic_len,j + 1,i);!drawersOpen?drawer.close():''">
                                        <span class="titleName"
                                            [ngClass]="(j===nextPrevHolder && i===moduleHolder) ? 'titleSelected' : ''">
                                            {{mod?.title | slice:0:56}}...
                                        </span>

                                    </span>

                                    <span class="topicnm" *ngIf="mod?.title.length < 65"
                                        (click)="playTopic(mod.link,mod.title,mod.status,res?.title,res?.status,scromModuleData?.length,res?.topic_len,j + 1,i);!drawersOpen?drawer.close():''">

                                        <span class="titleName"
                                            [ngClass]="(j===nextPrevHolder && i===moduleHolder) ? 'titleSelected' : ''">
                                            {{mod?.title}}
                                        </span>
                                    </span>

                                </ng-template>
                            </mat-step>
                        </ng-container>
                    </mat-vertical-stepper>
                </mat-card-content>
            </mat-card>



        </div>
        <!-- COURSE PLAYER -->
        <div style="width: 100%; border: 1px solid red;">
            <iframe title="player" id="myPlayer" class="player" [src]="urlSafe" allowfullscreen></iframe>
        </div>
    </div>
</div>
<ng-template #resourseWindow>
    <mat-dialog-title>
        <div class="d-flex justify-content-between rowMargin p-xy-10">
          <div class="d-flex justify-content-start align-items-center">
            <span class="f_wt_600 ">{{this.course?.course_name}}</span>
          </div>
         
          <div class="d-flex justify-content-start align-items-center text-right">
              <mat-icon class="download-icon" (click)="closedialogbox()">close</mat-icon>
          </div>
        </div>
      </mat-dialog-title>
      <mat-dialog-content class="no_padding no_margin">
        <div>
                <mat-tab-group #demo3Tab [(selectedIndex)]="selectedTabIndex" #tabs (selectedTabChange)="tabSelection($event)">
        
                    <!-- about the course tab -->
                    <mat-tab label="About the course" class="aboutCourseTab">
                        <div>
                            <h3><strong>{{'Details about the course' | translate}}</strong></h3>
                            <div class="vertical"></div>
        
                            <div><strong>{{ 'This course includes :' | translate}}</strong></div>
                            <div class="display_flex">
                                <div style="max-width: 196px;">
                                    <span ><strong>{{content?.totalResourseCount}}
                                       {{'downloadable resources'| translate}}</strong> </span>
                                </div>
        
                                <span *ngIf="course?.course_mode"> &nbsp; |&nbsp;</span>
                                <div style="max-width: 100px;">
                                    <span><strong>{{course?.course_mode === 'self-placed' ? 'Self paced' : course?.course_mode}}</strong></span>
                                </div>
        
                                <span *ngIf="course?.course_language"> &nbsp; |&nbsp;</span>
                                <div style="max-width: 78px;">
                                    <span>{{course?.course_language}}</span>
                                </div>
                            </div>
                            <div class="d-flex ">
                                    <div [innerHTML]="course?.course_long_description">
                                </div>
                            </div>
        
                            <div *ngIf="course?.author_details[0].author_name != ''">
                                <h3 class="head-h2">{{'Instructors'| translate}}</h3>
                                <div class="vertical"></div>
                                <div class="instr-box" *ngFor="let author of course?.author_details">
                                    <div class="row">
                                        <div class="col-4">
                                            <img class="img-inst"
                                                [src]="author.image ? author?.image : 'assets/learner/pro2.png'" alt="">
                                        </div>
                                        <div class="col-6">
                                            <div class="authorname">{{author?.author_name | titlecase| translate}}</div>
                                        </div>
        
                                        <div class="row margin-35 borderline">
                                            <div class="col-12 bottom-border">
                                                <p class="author-desc">{{author?.description}}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </mat-tab>
                    <!-- resource tab -->
                    <mat-tab label="Resources">
                        <div>
                            <!--[ngClass]="drawer.opened==true?'drawerOpnResource':'drawerClsResource'" -->
                            <mat-accordion>
                                <ng-container *ngIf="content?.noresource">
                                    <ng-container *ngFor="let res of content?.coursedetails; let i = index">
                                        <mat-expansion-panel class="panel1" hideToggle="true" #example1
                                            [expanded]="selectedIndex === i" *ngIf="res.resValue">
                                            <mat-expansion-panel-header style="height: 50px !important;">
                                                <mat-panel-title>
                                                    <span class="sqnumner">{{i+1}}.</span>&nbsp;&nbsp;{{res?.modulename}}<br>
                                                </mat-panel-title>
                                                <mat-icon class="exp2" *ngIf="!example1.expanded">add_circle_outline
                                                </mat-icon>
                                                <mat-icon class="exp2" *ngIf="example1.expanded">remove_circle_outline
                                                </mat-icon>
                                            </mat-expansion-panel-header>
        
        
                                            <div class="row margin-5">
                                                <div class="col-12">
                                                    <mat-list *ngFor="let mod of res?.moduledetails">
                                                        <mat-list-item *ngIf="res.resValue">
                                                            <div mat-line class="modTopName" *ngIf="mod.resourse?.files.length">
                                                                {{mod?.topicname}} :
                                                            </div>
                                                            <div class="content">
                                                                <div class="row" *ngFor="let file of mod.resourse?.files">
                                                                    <div class="col-12" style="margin-top:6px">
                                                                        <div class="row d-flex justify-content-between">
                                                                            <div class="extensionFiles">
                                                                                <img *ngIf="file.doc_type == 'application/pdf'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/PDF_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'link'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Link_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Excel_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'image/jpeg' || file.doc_type == 'image/png'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Image_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/PPT_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Word_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/msword'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Word_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/vnd.ms-excel'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Excel_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'video/mp4'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Video_Icon.svg">
                                                                            </div>
        
                                                                            <mat-icon class="docType"
                                                                                *ngIf="file.doc_type == 'text/plain' ">
                                                                                description
                                                                            </mat-icon>
                                                                            <div class="fileTypeName"> {{file.type_name}} </div>
                                                                            <div class="f_size_12"
                                                                                *ngIf="file?.doc_type =='link'">
                                                                                <span class="ml-2"> NA </span>
                                                                            </div>
                                                                            <div class="f_size_12 fileSize" *ngIf="file?.size">
                                                                                {{file.size}} </div>
                                                                            <div class="saveFile">
                                                                                <a href="{{file?.path}}"
                                                                                    (click)="add_topic_reference(res)" download>
                                                                                    <mat-icon
                                                                                        style="color: #333;font-size: 20px;">
                                                                                        save_alt </mat-icon>
                                                                                </a>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </mat-list-item>
                                                    </mat-list>
                                                </div>
                                            </div>
                                        </mat-expansion-panel>
                                    </ng-container>
                                </ng-container>
        
        
                                <ng-container *ngIf="!content?.noresource">
                                    <span style="padding: 16px;">{{'This course does not have resource files.'|
                                        translate}}</span>
                                </ng-container>
                            </mat-accordion>
                        </div>
                    </mat-tab>
                </mat-tab-group>
        </div>
        </mat-dialog-content>

</ng-template>