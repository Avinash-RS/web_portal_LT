<div oncontextmenu="return false" class="coursePlayerContainer" *ngIf="scromModuleData;else skeletonLoader">
    <app-header></app-header>
    <!-- TITLE AND BACK -->
    <div class="titlebar">
        <!-- <div class="downTitle"><i (click)="titleBar?titleBar=false:titleBar=true" [ngClass]="titleBar?'arrUp':'arrDown'" class="lxp-Arrow"></i></div>
        <div class="collapseFill"><i class="lxp-CollapseFill"></i></div> -->

        <div class="downTitle"><i (click)="titleBar = !titleBar" [ngClass]="titleBar?'arrDown':'arrUp'" class="lxp-Arrow"></i></div>
        <div class="collapseFill"><i (click)="!titleBar?titleBar=true:''" [ngClass]="!titleBar?'arrUp':'arrDown'" class="lxp-CollapseFill"></i></div>

        <div class="d-flex justify-content-start align-items-center titleBack animateAnimate" [ngClass]="titleBar==true?'fadeOutUp':'fadeInDown'">
            <div class="pointer d-flex align-items-center backcolor redHover" (click)="goBack()">
                <i class="lxp-Arrow backArrow"></i><span>Back</span>
            </div>
            <div class="navigation d-flex align-items-center" *ngIf="scromModuleData&&filterkey==='All'&&drawersOpen===false">
                <span class="pipeLine">|</span> 
                <div class="leftArrow">                
                 <i class="lxp-Next-Previous previousTopic" title="Previous Topic" [ngClass]="isprevEnable?'disableColor':''" (click)="isprevEnable?false:topicPrve()"></i>
                </div>
                <div class="currentTopic" title="{{scromModuleData[moduleHolder]?.children[nextPrevHolder].title}}">
                 <span >{{scromModuleData[moduleHolder]?.children[nextPrevHolder].title}}</span>
                </div>
                <div class="rightArrow">                
                 <i class="lxp-Next-Previous" title="Next Topic" [ngClass]="isNextEnable?'disableColor':''" (click)="isNextEnable?false:topicNext()"></i>
                </div>
            </div>
            <div class="courseTitle"> | <span>{{this.course?.course_name}}</span></div>
        </div>
    </div>
    <!-- COURSE TOOL BAR -->
    <!-- <div class="d-flex justify-content-between align-items-center toolBar">
       <div class="d-flex align-items-center leftContent">
           <div class="navigation d-flex align-items-center" *ngIf="scromModuleData">
               <div class="leftArrow">                
                <i class="lxp-Next-Previous previousTopic" title="Previous Topic" [ngClass]="isprevEnable?'disableColor':''" (click)="isprevEnable?false:topicPrve()"></i>
               </div>
               <div class="currentTopic" title="{{scromModuleData[moduleHolder]?.children[nextPrevHolder].title}}">
                <span >{{scromModuleData[moduleHolder]?.children[nextPrevHolder].title}}</span>
               </div>
               <div class="rightArrow">                
                <i class="lxp-Next-Previous" title="Next Topic" [ngClass]="isNextEnable?'disableColor':''" (click)="isNextEnable?false:topicNext()"></i>
               </div>
           </div>
       </div>
    </div> -->
    <!-- TOC AND PLAYER -->
    <div class="contentHeight d-flex">
        <div class="hamburgerPosition">
            <i class="lxp-HamburgerMenu" (click)="drawersOpen=drawersOpen?false:true"></i>
        </div>
        <!-- TOC DATA -->
        <div class="tocSize" [ngClass]="drawersOpen ? '': 'drawersOpen'">
            <div class="filterSection">
                Filter by: <select class="sel-pad" [(ngModel)]="filterkey" (change)="filterToc()">
                    <option [value]="'All'">All</option>
                    <option [value]="'Bookmarked'">Bookmarks</option>
                    
                </select>
            </div>
            <div class="xyz">
                <mat-card *ngFor="let res of filterkey=='Bookmarked'?filterData:scromModuleData; let i = index" [ngClass]="res.expanded ? 'expandClass':'collapseClass'" multi displayMode=""
                    (click)="getSelectedIndex(i)" class="topicCard" >
                    <div *ngIf="i===moduleHolder" #focuser ></div>
                            <mat-card-title (click)="moduleExpand(res,i)" class="d-flex justify-content-between align-items-center pointer">
                                <div class="tocTitle">Week - {{res.week?res.week:i+1}}</div>
                                <div>
                                    <i class="expandCollapse" [ngClass]="res.expanded?'lxp-Collapse':'lxp-Expand'"></i>
                                </div>
                            </mat-card-title>
                            <mat-card-subtitle (click)="moduleExpand(res,i)" class="d-flex justify-content-start align-items-center tocSubTitle">
                                <div>
                                    <!-- *ngIf="res?.status == 'Passed'" -->
                                    <mat-icon *ngIf="res?.status == 'Passed'" class="material-icons passColor" >done </mat-icon>
                                    <mat-icon *ngIf="res?.status == 'process'" class="material-icons processColor" >done </mat-icon>
                                    <mat-icon *ngIf="res?.status == null" class="material-icons mar" >done </mat-icon>
                                </div>
                                <div>
                                    <span *ngIf="res?.title?.length >= 67" class="moduleName" tooltip="{{res?.title}}"
                                        placement="right">
                                        {{res?.title | slice:0:71}}...</span>
                                    <span *ngIf="res?.title?.length < 67" class="moduleName">
                                        {{res?.title}}
                                    </span>
                                </div>
                            </mat-card-subtitle>

                    <mat-card-content *ngIf="(res.expanded)">
                        <!-- TOPICS LIST STARTS HERE... -->
                        <mat-vertical-stepper [linear]="isLeaner" [ngClass]="res?.title?.length > 39?'headerDown': ''">
                            <ng-container *ngFor="let mod of res?.children; let j = index">
                                <mat-step
                                    [aria-labelledby]="mod?.status === 'Passed' ? 'colgreen' :  mod?.status === 'process' ? 'colYellow' : 'colWhite'">
                                    <ng-template matStepLabel>
                                        <span class="topicnm" 
                                            (click)="playTopic(mod.link,mod.title,mod.status,res?.title,res?.status,scromModuleData?.length,res?.topic_len,j + 1,i);drawersOpen=performOverLay?(drawersOpen?false:true):true">

                                                <span class="titleName"
                                                    [ngClass]="(j===nextPrevHolder && i===moduleHolder) ? 'titleSelected' : ''">
                                                    {{mod?.title}}
                                                </span>
                                                <span *ngIf="mod.bookmark===true "><i class="lxp-bookmark" style="color:blue"></i></span>
                                            </span>

                                        </ng-template>
                                    </mat-step>
                                </ng-container>
                            </mat-vertical-stepper>
                        </mat-card-content>
                </mat-card>
            </div>
        </div>
        <!-- COURSE PLAYER -->
        <div class="videoPlayer" [ngClass]="drawersOpen ? 'halfWidth' : 'fullWidth'">
            <iframe title="player" id="myPlayer" class="player" [src]="urlSafe" allowfullscreen></iframe>
            <div class="d-flex justify-content-between understoodBookmark">
                <div class="d-flex justify-content-between align-items-center understoodButton">
                    <button type="button" [disabled]="topicPageStatus !== 'Passed'" [ngClass]="topicPageStatus==='Passed'&& topicInfo?.user_experience === 'like'?'btn btn-outline-success':'btn btn-outline-light'" (click)="understoodClick('like')">
                        <i class="lxp-smile"></i> Understood
                    </button>
                    <button type="button" [disabled]="topicPageStatus !== 'Passed'" [ngClass]="topicPageStatus==='Passed' && topicInfo?.user_experience === 'dislike'?'btn btn-outline-danger':'btn btn-outline-light'" (click)="understoodClick('dislike')">
                        <i class="lxp-sad"></i> Not Understood
                    </button>
                </div>
                <div class="d-flex bookmarkButton">
                    <button type="button" [disabled]="filterkey==='Bookmarked'" ngClass="btn btn-outline-light" (click)="bookmarkClick(topicInfo?.bookmark?false:true)">
                        <i [ngClass]="topicInfo?.bookmark?'lxp-bookmark':'lxp-bookmark-o'"></i> {{topicInfo?.bookmark?'Bookmarked':'Add to Bookmark'}}
                    </button>
                </div>
            </div>
            <!-- <div class="rightContent">
                <div (click)="makeFullScreen()" data-title="Fullscreen" class="fullScr d-flex align-items-center iconSize">
                    <i  class="lxp-Fullscreen"></i>
                </div>
                <div (click)="openResourse(resourseWindow)" data-title="Resources" class="resourceTab d-flex align-items-center iconSize">
                    <i  class="lxp-res-popout f_size_14"></i>
                </div>
            </div> -->
        </div>
    </div>
</div>
<ng-template #resourseWindow>
    <!-- <mat-dialog-title>
        <div class="d-flex justify-content-between rowMargin p-xy-10">
            <div class="d-flex justify-content-start align-items-center">
            <span class="f_wt_600 ">{{this.course?.course_name}}</span>
            </div>
            
            <div class="d-flex justify-content-start align-items-center text-right">
                <mat-icon class="download-icon" (click)="closedialogbox()">close</mat-icon>
            </div>
        </div>
    </mat-dialog-title> -->
      <mat-dialog-content class="no_padding no_margin popupTab">
        <div class="popupContainer">
            <div class="closeSection">
                <i (click)="closedialogbox()" class="lxp-Close"></i>
            </div>
                <mat-tab-group #demo3Tab [(selectedIndex)]="selectedTabIndex" #tabs (selectedTabChange)="tabSelection($event)">
        
                    <!-- resource tab -->
                    <mat-tab label="Resources">
                        <div class="d-flex rescontentHeight">
                                <div class="resourseToc" >
                                    <ng-container *ngIf="content?.noresource">
                                        <ng-container  *ngFor="let res of content?.coursedetails; let i = index">
                                            <mat-card class="resource-card" *ngIf="res.resValue" [ngClass]="res.isOpen?'activeTab':'inActiveTab'">
                                            <mat-card-title class="d-flex justify-content-between align-items-center pointer" (click)="resourseAccord(content?.coursedetails, i);">
                                                <h4>{{res?.modulename}}</h4>
                                                <div style="display: inline-flex;"><i class="lxp-Arrow" [ngClass]="res.isOpen?'arrowUp':'arrowDown'"></i></div>
                                            </mat-card-title>
                                            <div *ngIf="res.isOpen">
                                            <ng-container *ngFor="let mod of res?.moduledetails">
                                                <mat-card-subtitle>
                                                    <h5 mat-line class="modTopName" [title]="mod?.topicname" *ngIf="mod.resourse?.files.length">
                                                        {{mod?.topicname}}
                                                    </h5>
                                                </mat-card-subtitle>
                                                <mat-card-content>
                                                    <mat-card class="resource-card d-flex justify-content-start" mat-ripple (click)="urlBinder(file); add_topic_reference(res)" *ngFor="let file of mod.resourse?.files">
                                                        <div class="mr-2">
                                                            <img *ngIf="file.doc_type == 'application/pdf'" class="size" alt=""
                                                                src="assets/learner/fileicon/PDF_Icon.svg">
                                                            <img *ngIf="file.doc_type == 'link'" class="size" alt="" src="assets/learner/fileicon/Link_Icon.svg">
                                                            <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                                                class="size" alt="" src="assets/learner/fileicon/Excel_Icon.svg">
                                                            <img *ngIf="file.doc_type == 'image/jpeg' || file.doc_type == 'image/png'" class="size" alt=""
                                                                src="assets/learner/fileicon/Image_Icon.svg">
                                                            <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                                                class="size" alt="" src="assets/learner/fileicon/PPT_Icon.svg">
                                                            <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                                                class="size" alt="" src="assets/learner/fileicon/Word_Icon.svg">
                                                            <img *ngIf="file.doc_type == 'application/msword'" class="size" alt=""
                                                                src="assets/learner/fileicon/Word_Icon.svg">
                                                            <img *ngIf="file.doc_type == 'application/vnd.ms-excel'" class="size" alt=""
                                                                src="assets/learner/fileicon/Excel_Icon.svg">
                                                            <img *ngIf="file.doc_type == 'video/mp4'" class="size" alt="" src="assets/learner/fileicon/Video_Icon.svg">
                                                            <mat-icon class="docType" *ngIf="file.doc_type == 'text/plain' "> description </mat-icon>
                                                        </div>
                                                        <div>{{file.type_name}}</div>
                                                    </mat-card>
                                                </mat-card-content>
                                            </ng-container>
                                        </div>
                                        </mat-card>
                                        </ng-container>
                                        
                                    </ng-container>
                                    <ng-container *ngIf="!content?.noresource">
                                        No Resource found !!
                                    </ng-container>
                                    
                                <!-- <mat-accordion>
                                <ng-container *ngIf="content?.noresource">
                                    <ng-container *ngFor="let res of content?.coursedetails; let i = index">
                                        <mat-expansion-panel class="panel1" hideToggle="true" #example1
                                            [expanded]="selectedIndex === i" *ngIf="res.resValue">
                                            <mat-expansion-panel-header style="height: 50px !important;">
                                                <mat-panel-title>
                                                    <span class="sqnumner">{{i+1}}.</span>&nbsp;&nbsp;{{res?.modulename}}<br>
                                                </mat-panel-title>
                                                <mat-icon class="exp2" *ngIf="!example1.expanded">add_circle_outline
                                                </mat-icon>
                                                <mat-icon class="exp2" *ngIf="example1.expanded">remove_circle_outline
                                                </mat-icon>
                                            </mat-expansion-panel-header>
        
        
                                            <div class="row margin-5">
                                                <div class="col-12">
                                                    <mat-list *ngFor="let mod of res?.moduledetails">
                                                        <mat-list-item *ngIf="res.resValue">
                                                            <div mat-line class="modTopName" *ngIf="mod.resourse?.files.length">
                                                                {{mod?.topicname}} :
                                                            </div>
                                                            <div class="content">
                                                                <div class="row" *ngFor="let file of mod.resourse?.files">
                                                                    <div class="col-12" style="margin-top:6px">
                                                                        <div class="row d-flex justify-content-between">
                                                                            <div class="extensionFiles">
                                                                                <img *ngIf="file.doc_type == 'application/pdf'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/PDF_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'link'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Link_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Excel_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'image/jpeg' || file.doc_type == 'image/png'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Image_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/PPT_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Word_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/msword'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Word_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'application/vnd.ms-excel'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Excel_Icon.svg">
                                                                                <img *ngIf="file.doc_type == 'video/mp4'"
                                                                                    class="size" alt=""
                                                                                    src="assets/learner/fileicon/Video_Icon.svg">
                                                                            </div>
        
                                                                            <mat-icon class="docType"
                                                                                *ngIf="file.doc_type == 'text/plain' ">
                                                                                description
                                                                            </mat-icon>
                                                                            <div class="fileTypeName"> {{file.type_name}} </div>
                                                                            <div class="f_size_12"
                                                                                *ngIf="file?.doc_type =='link'">
                                                                                <span class="ml-2"> NA </span>
                                                                            </div>
                                                                            <div class="f_size_12 fileSize" *ngIf="file?.size">
                                                                                {{file.size}} </div>
                                                                            <div class="saveFile">
                                                                                <a href="{{file?.path}}"
                                                                                    (click)="add_topic_reference(res)" download>
                                                                                    <mat-icon
                                                                                        style="color: #333;font-size: 20px;">
                                                                                        save_alt </mat-icon>
                                                                                </a>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </mat-list-item>
                                                    </mat-list>
                                                </div>
                                            </div>
                                        </mat-expansion-panel>
                                    </ng-container>
                                </ng-container>
        
        
                                <ng-container *ngIf="!content?.noresource">
                                    <span style="padding: 16px;">{{'This course does not have resource files.'|
                                        translate}}</span>
                                </ng-container>
                            </mat-accordion> -->
                                </div>
                                <div class="previewContainer" >
                                    <div class="previewContainerTitle">
                                        <p>{{resourceName}}</p>
                                    </div>
                                    <ng-container *ngIf="isCancelLoad">
                                        <!-- <mat-icon [ngClass]="{'preview-cancel-pdf': fileType == 'pdf','preview-cancel' : (fileType == 'image' || fileType == 'video')}" (click)="onClose()">cancel</mat-icon> -->
                                      </ng-container>
                                      <ng-container *ngIf="fileType == 'image'">
                                        <div class="d-flex justify-content-center align-items-center">
                                          <img [src]="URIData" alt="image">
                                        </div>
                                      </ng-container>
                                    
                                      <ng-container *ngIf="fileType == 'pdf'&& URIData!==null">
                                        <!-- <app-pdfreader [url]="URIData"
                                         [original-size]="false"></app-pdfreader> -->
                                        <!-- <object data="{{URIData}}" type="application/pdf" width="100%" height="100%">
                                            <iframe src="{{URIData}}" width="100%" height="100%" style="border: none;">
                                                <p>Your browser does not support PDFs.
                                                    <a href="{{URIData}}">Download the PDF</a>.
                                                </p>
                                            </iframe>
                                        </object> -->
                                        <iframe title="file" width="100%" height="100%" [src]="URIData" allowfullscreen></iframe>
                                    
                                      </ng-container>
                                    
                                      <ng-container *ngIf="fileType == 'video'">
                                        <video  oncontextmenu="return false;" [src]="URIData" title="image" width="100%" height="100%" controls controlsList="nodownload"></video>
                                      </ng-container>
                                    
                                      <ng-container *ngIf="fileType == 'audio'" controlsList="nodownload">
                                        <audio oncontextmenu="return false;" class="audio-player" [src]="URIData" title="image" width="100%" height="100%" controls controlsList="nodownload"></audio>
                                      </ng-container>
                                </div>
                            <!--[ngClass]="drawer.opened==true?'drawerOpnResource':'drawerClsResource'" -->
                            
                        </div>
                    </mat-tab>

                    <!-- about the course tab -->
                    <mat-tab label="About the course">
                        <div class="aboutCourseTab">
                            <h2>{{'Details about the course' | translate}}</h2>
                            <!-- <h6>{{ 'This course includes :' | translate}}</h6>
                            <ul class="countCourseLanguage">
                                <li>{{content?.totalResourseCount}} Resource File(s)</li>
                                <li *ngIf="course?.course_mode">{{course?.course_mode === 'self-placed' ? 'Self paced' : course?.course_mode}}</li>
                                <li *ngIf="course?.course_language">{{course?.course_language}}</li>
                            </ul> -->
                            <div class="descriptionContent">
                                <p [innerHTML]="course?.course_long_description"></p>
                            </div>
                            <div *ngIf="course?.author_details[0].author_name != ''">
                                <h2>{{'Instructors'| translate}}</h2>
                                <div class="">
                                    <div class="instructionBox" *ngFor="let author of course?.author_details">
                                        <div class="d-flex justify-content-between">
                                            <figure>
                                                <img class="img-inst" [src]="author.image ? author?.image : 'assets/learner/pro2.png'" alt="" />
                                            </figure>
                                            <div class="authorDescription">
                                                <h5>{{author?.author_name | titlecase| translate}}</h5>
                                                <p>{{author?.description}}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </mat-tab>
                </mat-tab-group>
            </div>
        </mat-dialog-content>
</ng-template>

<ng-template #skeletonLoader>
<div class="item">
    <mat-card class="courseDetailSkeleton" style="box-shadow: none !important;">
        <div class="breadcrumbskeleton">
            <ngx-skeleton-loader count="1" animation="pulse" [theme]="{ 'border-radius': '0', height: '50px', 'background-color': '#888888', 'border-radius': '10px' }"></ngx-skeleton-loader>
        </div>
        <div class="d-flex justify-content-between">
            <div class="item" style="width: 30%;">
                <div class="d-flex justify-content-between">
                    <ngx-skeleton-loader [theme]="{'background-color': '#888888'}" appearance="circle" animation="pulse" [theme]="{width: '190px',height: '120px','border-radius': '10px'}"></ngx-skeleton-loader>
                    <ngx-skeleton-loader count="1" animation="pulse" [theme]="{ 'border-radius': '0', width: '150px', height: '50px', 'background-color': '#888888', 'border-radius': '10px' }"></ngx-skeleton-loader>
                </div>
                <div class="item">
                    <ngx-skeleton-loader count="5" animation="pulse" [theme]="{ 'border-radius': '0', height: '70px', 'background-color': '#888888', 'border-radius': '10px' }"></ngx-skeleton-loader>
                </div>
            </div>
            
            <div class="item" style="width: 69%;">
                <ngx-skeleton-loader count="1" animation="pulse" [theme]="{ 'border-radius': '0', height: '410px', 'background-color': '#888888', 'border-radius': '10px' }"></ngx-skeleton-loader>
                <div class="d-flex justify-content-between" style="width: 100%;">
                    <div class="item d-flex justify-content-between" style="width: 40%;">
                        <ngx-skeleton-loader count="1" animation="pulse" [theme]="{ 'border-radius': '0', height: '50px', width: '150px', 'background-color': '#888888', 'border-radius': '10px' }"></ngx-skeleton-loader>
                        <ngx-skeleton-loader count="1" animation="pulse" [theme]="{ 'border-radius': '0', height: '50px', width: '150px', 'background-color': '#888888', 'border-radius': '10px' }"></ngx-skeleton-loader>
                    </div>
                    <div class="item d-flex justify-content-between" style="width: 40%; text-align: right;">
                        <ngx-skeleton-loader count="1" animation="pulse" [theme]="{ 'border-radius': '0', height: '50px', width: '150px', 'background-color': '#888888', 'border-radius': '10px' }"></ngx-skeleton-loader>
                        <ngx-skeleton-loader count="1" animation="pulse" [theme]="{ 'border-radius': '0', height: '50px', width: '150px', 'background-color': '#888888', 'border-radius': '10px' }"></ngx-skeleton-loader>
                    </div>
                </div>
            </div>
        </div>
    </mat-card>
</div>
</ng-template>