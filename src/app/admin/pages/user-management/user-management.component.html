<div style="overflow: hidden;">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a [routerLink]="['/Admin/auth/userManagement']">Home</a></li>
      <li class="breadcrumb-item active" aria-current="page">View users</li>
    </ol>
  </nav>

  <div class="row no_margin">
    <div class="col-lg-4 col-md-4 col-sm-12 col-12">
      <h1 style="padding-left: 10px;">User management</h1>
    </div>
    <div class="col-lg-7 col-md-6 col-sm-12 col-12 float_right">
      <input class="form-control m-b-10" type="text" placeholder="Search" (keyup)="applyFilter($event.target.value)"
        aria-label="Search">
    </div>

    <div class="col-lg-1 col-md-2 col-sm-12 col-12 float_right">
      <button mat-button (click)="gotoAddUser()" class="float_right" [routerLink]="['/Admin/auth/addUser']">
        <mat-icon style="color: white;">add</mat-icon>Add user
      </button>
    </div>
  </div>
  <!-- <div fxLayout="row" fxLayoutAlign="space-around center" *ngIf="loader" style="height:100%">
    <mat-spinner diameter="50" strokeWidth="5"></mat-spinner>
  </div> -->

  <hr style="border: 1px solid #ccc;margin:0 !important; ">
  <div>
    <div class="example-container">
      <mat-table #table [dataSource]="dataSource" matSort>
        <ng-container matColumnDef="select">
          <mat-header-cell *matHeaderCellDef>
            <!-- Select -->
          </mat-header-cell>
          <mat-cell *matCellDef="let row">
            <span class="mobile-label">
              <!-- Select -->
            </span>
            <mat-checkbox (change)="checkboxLabel(row)">
            </mat-checkbox>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="user_id">
          <mat-header-cell *matHeaderCellDef mat-sort-header> User id </mat-header-cell>
          <mat-cell>
            sdiuio
          </mat-cell>

          <mat-cell *matCellDef="let element">
            <span class="mobile-label">User id</span>
            <span class="desktop-data"> {{element.user_id}}</span>
            <span class="mobile-data"> {{element.user_id}}</span>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="username">
          <mat-header-cell *matHeaderCellDef mat-sort-header> User name </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <span class="mobile-label">User name</span>
            <span class="desktop-data"> {{element.username}}</span>
            <span class="mobile-data"> {{element.username}}</span>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="email">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Email id </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <span class="mobile-label">Email id</span>
            <span class="desktop-data"> {{element.email || 'NA'}}</span>
            <span class="mobile-data"> {{element.email || 'NA'}}</span>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="mobile">
          <mat-header-cell *matHeaderCellDef> Mobile no </mat-header-cell>
          <mat-cell *matCellDef="let element"> <span class="mobile-label">Mobile no</span>
            <span class="desktop-data"> {{element.mobile_number || 'NA'}}</span>
            <span class="mobile-data">&nbsp;&nbsp; {{element.mobile_number || 'NA'}}</span>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="active">
          <mat-header-cell *matHeaderCellDef> Status </mat-header-cell>
          <mat-cell *matCellDef="let element"
            [ngClass]="element.is_blocked ? 'red f_wt_500' : element.is_active ? 'green f_wt_500' : 'black f_wt_500'">
            <span class="mobile-label">Status</span>
            <span class="desktop-data">
              <!-- {{element.is_blocked ? 'Blocked' : element.is_active ? 'Active' : 'Inactive'}}</span> -->
              {{ element.is_active ? 'Active' : 'Inactive'}}</span>
            <span class="mobile-data">
              {{ element.is_active ? 'Active' : 'Inactive'}}</span></mat-cell>
        </ng-container>

        <ng-container matColumnDef="actions">
          <mat-header-cell *matHeaderCellDef (click)="deActivate()" class="pointer">
            Actions <br *ngIf="selectedArray && selectedArray.length > 0">
            <button *ngIf="selectedArray && selectedArray.length > 0" mat-stroked-button
              (click)="deActivate('Activate')">
              Activate</button>
            <button mat-stroked-button *ngIf="selectedArray && selectedArray.length > 0"
              (click)="deActivate('De-activate')">
              De-activate</button>
            <!-- <button mat-stroked-button *ngIf="selectedArray && selectedArray.length > 0" (click)="block('Block')">
              Block</button> -->
            <!-- <button mat-stroked-button *ngIf="selectedArray && selectedArray.length > 0" (click)="block('Unblock')">
              Un-block</button> -->
          </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <span class="mobile-label">Actions</span>

            <button mat-icon-button (click)="viewDetail(element,viewDialog)" data-toggle="tooltip" data-placement="top"
              title="View {{element.username}}'s details">
              <mat-icon style="color: #ccc;font-size:20px; width:20px;">remove_red_eye</mat-icon>
            </button>
            <button *ngIf="!element.is_blocked" mat-stroked-button id="deactivate"
              [disabled]="(selectedArray && selectedArray.length > 0)"
              (click)="deActivate(!element.is_blocked && element.is_active ? 'De-activate' : 'Activate',element)">
              {{element.is_active ? 'De-activate' : 'Activate'}}</button>
            <!-- <button *ngIf="!element.is_blocked" mat-stroked-button
              [disabled]="(selectedArray && selectedArray.length > 0)" (click)="block('Block',element)">
              Block</button> -->
          </mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="displayedColumns;sticky: true"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns;" (click)="selection.toggle(row)">
        </mat-row>
      </mat-table>
    </div>

    <mat-paginator #paginator [length]="resultsLength" [pageSize]="10" (page)="next($event)" showFirstLastButtons>
    </mat-paginator>
    <br><br>

    <ng-template #viewDialog class="dialogPopup">
      <span class="close">
        <i class="fa fa-times-circle-o pointer" aria-hidden="true" (click)="closedialogbox()"></i>
      </span>

      <mat-tab-group>
        <mat-tab label="View details">
          <br>
          <mat-dialog-content style="width: 1000px;margin:0">
            <form #profileForm="ngForm">
              <div class="container profile">
                <div class="row">
                  <!-- //////FIrst section left part//////// -->
                  <div class="col-md-6 col-sm-12 col-12 left">
                    <!-- ////// Info about you//////// -->
                    <br>
                    <div class="form-group">
                      <label>Information about you</label>
                      <textarea style="resize: none;" readonly [disabled]='cannotEdit' rows="3"
                        class="inputs border-radius-5 color_blue background_trans width_100"
                        [(ngModel)]="profileDetails.userObjects && profileDetails.userObjects[0].about_you"
                        name="info"></textarea>
                    </div>
                  </div>

                  <div class="col-md-6 col-sm-12 col-12 right float_right">
                    <img
                      [src]="profileDetails.userObjects && profileDetails.userObjects[0].profile_img ? profileDetails.userObjects[0].profile_img : 'assets/learner/avatar2.png'"
                      id="imageUpload" alt="Avatar" class="avatar">
                  </div>
                </div>
                <br>
                <div class="row">
                  <!-- //////userName  +++ full name +++ Phone//////// -->
                  <div class="col-md-4 col-sm-12 col-12">
                    <label>User name : <label
                        class="color_black capitalize f_wt_400">{{profileDetails.userObjects && profileDetails.userObjects[0].username || 'NA'}}</label></label>
                  </div>
                  <div class="col-md-4 col-sm-12 col-12">
                    <label>Full name : <label
                        class="color_black capitalize f_wt_400">{{profileDetails.userObjects && profileDetails.userObjects[0].full_name || 'NA'}}
                      </label></label>
                  </div>
                  <div class="col-md-4 col-sm-12 col-12">
                    <label>Mobile : <label
                        class="color_black capitalize f_wt_400">{{profileDetails.userObjects && profileDetails.userObjects[0].mobile_number || 'NA'}}</label></label>
                  </div>
                </div>

                <!-- ////// Email ++ gender ++ Iam a//////// -->
                <div class="row">
                  <div class="col-md-4 col-sm-12 col-12">
                    <label>Email : <label
                        class="color_black capitalize f_wt_400">{{profileDetails.userObjects && profileDetails.userObjects[0].email || 'NA'}}</label></label>
                  </div>
                  <div class="col-md-4 col-sm-12 col-12">
                    <label>Gender : <label class="color_black capitalize f_wt_400">{{profileDetails.userObjects && profileDetails.userObjects[0].gender == 'M' ? 'Male' : profileDetails.userObjects[0].gender == 'F' ?
                      'Female' : 'Rather not specify'}}</label></label>
                  </div>
                  <div class="col-md-4 col-sm-12 col-12">
                    <label>I'm a : <label class="color_black capitalize f_wt_400">
                        {{profileDetails.userObjects && profileDetails.userObjects[0].is_student_or_professional  || 'NA'}}</label>
                    </label>
                  </div>
                </div>

                <!-- //////Language known//////// -->
                <div class="row">
                  <div class="col-md-4 col-sm-12 col-12">
                    <label>Languages known : </label><br>
                    <div *ngIf="profileDetails.language.length >0">
                      <div *ngFor="let lang of profileDetails.language" class="display_flex">
                        {{lang}}
                      </div>
                    </div>
                    <div *ngIf="profileDetails.language.length == 0" class="color_black">
                      NA
                    </div>
                  </div>
                  <div class="col-md-6 col-sm-12 col-12">
                    <label>Location : <label class="color_black capitalize f_wt_400">
                        {{profileDetails.userObjects && profileDetails.userObjects[0].state_name || 'NA'}}
                        {{profileDetails.userObjects && profileDetails.userObjects[0].country_name  
                       }} </label></label>
                  </div>
                </div><br>
                <!-- commented till profile structure fix -->
                <!-- <div class="row" style="overflow-x:auto;">
                  <div class="col-md-12 col-sm-12 col-12">
                    <table class="profileTable">
                      <tr>
                        <th>Board</th>
                        <th>Discipline</th>
                        <th>Institute</th>
                        <th>Level</th>
                        <th>Specification</th>
                        <th>Year of Passing</th>
                        <th>Percentage</th>
                      </tr>
                      <tr *ngFor="let qual of profileDetails.qualification">
                        <td>{{qual.Board_Name}}</td>
                        <td>{{qual.discipline_name}}</td>
                        <td>{{qual.institute_name}}</td>
                        <td>{{qual.level_name}}</td>
                        <td>{{qual.specification_name}}</td>
                        <td>{{qual.year_of_passing}}</td>
                        <td>{{qual.percentage}}</td>
                      </tr>
                    </table>
                  </div>
                </div> -->
              </div>
            </form>
          </mat-dialog-content>
          <!-- <mat-dialog-actions> -->
          <!--Button code-->
          <!-- </mat-dialog-actions> -->
        </mat-tab>

        <mat-tab label="Track details">
          <br> <br>
          <mat-dialog-content style="width: 1000px;margin:0">
            <div class="container profile">
              <div class="row">
                <!-- //////userName  +++ full name +++ Phone//////// -->
                <div class="col-md-6 col-sm-12 col-12">
                  <label>No. of courses enrolled : <label
                      class="color_black capitalize f_wt_400">{{trackDetails && trackDetails.enrolled_course_count || 0}}</label></label>
                </div>
                <div class="col-md-6 col-sm-12 col-12">
                  <label>No. of wishlisted courses : <label
                      class="color_black capitalize f_wt_400">{{trackDetails && trackDetails.wishlist_count || 0}}</label>
                  </label>
                </div>
              </div>
              <br>
              <!-- //////Language known//////// -->
              <div class="row">
                <div class="col-md-6 col-sm-12 col-12">
                  <label>Last login time : <label class="color_black capitalize f_wt_400">
                      {{trackDetails && trackDetails.last_login[0] | date:short }}
                    </label> </label>
                </div>
                <div class="col-md-6 col-sm-12 col-12">
                  <label>Registered on : <label class="color_black capitalize f_wt_400">
                      {{trackDetails && trackDetails.userObjects[0].registered_date | date:short}}
                    </label> </label>
                </div>
              </div>
            </div>
          </mat-dialog-content>
        </mat-tab>
      </mat-tab-group>
      <br>
    </ng-template>

  </div>
</div>