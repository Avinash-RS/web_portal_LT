<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a [routerLink]="['/Admin/auth/dashboard']">Home</a></li>
    <li class="breadcrumb-item"><a [routerLink]="['/Admin/auth/Wca']">My courses</a></li>
    <li class="breadcrumb-item">Publish course</li>
    <li class="breadcrumb-item active" aria-current="page">{{course && course.name}}</li>
  </ol>
</nav>

<div class="container profile p-30">
  <h1> Publish course</h1>
  <br>
  <div class="container m-t-20">
    <div class="row shadow">
      <!-- Mat tree code here ( left hand side) -->
      <div class="card col-12 col-lg-3 col-md-4 col-sm-12 cardheight left" infiniteScroll [infiniteScrollDistance]="2"
        [scrollWindow]="false" [infiniteScrollThrottle]="500" (scrolled)="onScrollDown()">
        <h2 class="list-title m-t-20 m-l-5 m-r-20 color_grey">Associate to category </h2>

        <div class="spinner-container" *ngIf="loadingCategory">
          <mat-spinner diameter="40"></mat-spinner>
        </div>
        <mat-tree [dataSource]="treeSource" [treeControl]="treeControl" [trackBy]="trackBy">
          <!-- This is the tree node template for leaf nodes -->
          <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
            <li class="mat-tree-node newstyle" renderDebug>
              <!-- use a disabled button to provide padding for tree leaf -->
              <button mat-icon-button matTreeNodeToggle class="btnClassicon" (click)="loadsubcategory(node)"
                [attr.aria-label]="'toggle ' + node.name">
                <mat-icon *ngIf="node?.is_child == true" class="mat-icon-rtl-mirror">
                  {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                </mat-icon>
              </button>
              <mat-checkbox name="checkbox" [(ngModel)]="node.checkbox" (change)="selectedcategory(node)">
                {{node?.category_name}} {{node?.sub_category_name}} {{node?.super_sub_category_name}}</mat-checkbox>
            </li>
          </mat-tree-node>
          <!-- node with children -->
          <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
            <li class="mat-tree-node newstyle" renderDebug>
              <div class="mat-tree-node">
                <button mat-icon-button matTreeNodeToggle class="btnClassicon"
                  [attr.aria-label]="'toggle ' + node.name">
                  <mat-icon *ngIf="node?.is_child == true" class="mat-icon-rtl-mirror">
                    {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                  </mat-icon>
                </button>
                <mat-checkbox name="checkbox" [(ngModel)]="node.checkbox" (change)="selectedcategory(node)">
                  {{node?.category_name}} {{node?.sub_category_name}} {{node?.super_sub_category_name}}</mat-checkbox>
              </div>
            </li>
            <ul [class.children-invisible]="!treeControl.isExpanded(node)">
              <ng-container matTreeNodeOutlet></ng-container>
            </ul>
          </mat-nested-tree-node>
        </mat-tree>
        <!-- view category and sub category -->
      </div>
      <!-- end of Mat tree code here ( left hand side) course_id: "62tw3ynl"-->
      <!-- start of right hand side card view -->
      <div class="card col-lg-9 col-md-8 col-sm-12 col-12 cardheight right">
        <h2 class="list-title m-t-20 m-l-5 m-r-20 color_grey">Publish course </h2>
        <br><br>

        <div class="row m-l-5" *ngIf="selectedCategory?.category_name">
          <h4>
            Selected level 1 : {{selectedCategory?.category_name}}
          </h4>
        </div>

        <div class="row m-l-5" *ngIf="selectedSubCategory?.sub_category_name">
          <h4>
            Selected level 2 : {{selectedSubCategory?.sub_category_name}}
          </h4>
        </div>

        <div class="row m-l-5" *ngIf="selectedSuperSubCategory?.super_sub_category_name">
          <h4>
            Selected level 3 : {{selectedSuperSubCategory?.super_sub_category_name}}
          </h4>
        </div>
        <div class="row  center" *ngIf="selectedCategory?.category_name == undefined">
          <h4 class="m-l-10 center_align f_wt_500">
            Please select category to publish course..
          </h4>
        </div>
        <div class="row m-l-5" *ngIf="selectedCategory?.category_name">
          <h3>
            Selected category : {{selectedCategory?.category_name}}
            <strong>
              {{selectedSubCategory?.sub_category_name ? ' > ' +selectedSubCategory?.sub_category_name : null}}</strong>
            <strong>
              {{selectedSuperSubCategory?.super_sub_category_name ? ' > ' +selectedSuperSubCategory?.super_sub_category_name : null}}</strong>
          </h3>
        </div>

        <div class="row m-l-5" *ngIf="selectedCategory?.category_name">
          <mat-form-field>
            <mat-label>Select catalogue</mat-label>
            <mat-select name="catalogue" [(ngModel)]="catalogue" #catelogue1="ngModel" [required]=editstatus
              class="form-control">
              <mat-option *ngFor="let cat of catalogueList" [(value)]="cat.catalogue_id"
                (onSelectionChange)="selectcatalogue($event, cat)">
                {{cat.catalogue_name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <br><br>
        <div class="row width_100 alert-btn" *ngIf="selectedCategory?.category_name">
          <div class="col-md-2"></div>
          <div class="col-md-4 col-sm-6 col-6 ">
            <button mat-raised-button class="background-blue color_white width_70"
              [disabled]="selectedCategory?.category_name == undefined || selectedcatalogue == null"
              (click)="publishCourse()">Publish</button>
          </div>
          <div class="col-md-4  col-sm-6 col-6 ">
            <button mat-raised-button class="width_70" (click)="draftCourse()">Cancel</button>
          </div>
          <div class="col-md-2"></div>
        </div>
        <br>

      </div>
      <!-- end of right hand side card view -->
    </div>
    <br><br>
  </div>
  <br><br>
</div>